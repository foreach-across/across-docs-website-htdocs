<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.0">
<meta name="author" content="Arne Vandamme, Marc Vanbrabant, Andy Debrouwer">
<title>Across framework</title>
<style>
/*
 * Copyright 2014 the original author or authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
@import url(https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic|Noto+Serif:400,400italic,700,700italic|Droid+Sans+Mono:400,700);
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: rgba(0, 0, 0, 0.8); padding: 0; margin: 0; font-family: "Noto Serif", "DejaVu Serif", serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.spread { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.45; color: #7a2518; font-weight: normal; margin-top: 0; margin-bottom: 0.25em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #2156a5; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #1d4b8f; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Open Sans", "DejaVu Sans", sans-serif; font-weight: 300; font-style: normal; color: #ba3925; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.0125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #e99b8f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #ddddd8; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace; font-weight: normal; color: rgba(0, 0, 0, 0.9); }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: rgba(0, 0, 0, 0.8); border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.9375em; color: rgba(0, 0, 0, 0.6); }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: rgba(0, 0, 0, 0.6); }

blockquote, blockquote p { line-height: 1.6; color: rgba(0, 0, 0, 0.85); }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dedede; }
table thead, table tfoot { background: #f7f8f7; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: rgba(0, 0, 0, 0.8); text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: rgba(0, 0, 0, 0.8); }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f8f8f7; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }

body { tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; word-spacing: -0.05em; }
h1 strong, h2 strong, h3 strong, #toctitle strong, .sidebarblock > .content > .title strong, h4 strong, h5 strong, h6 strong { font-weight: 400; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: 0.9375em; font-style: normal !important; letter-spacing: 0; padding: 0.1em 0.5ex; word-spacing: -0.15em; background-color: #f7f7f8; -webkit-border-radius: 4px; border-radius: 4px; line-height: 1.45; text-rendering: optimizeSpeed; }

pre, pre > code { line-height: 1.45; color: rgba(0, 0, 0, 0.9); font-family: "Droid Sans Mono", "DejaVu Sans Mono", "Monospace", monospace; font-weight: normal; text-rendering: optimizeSpeed; }

.keyseq { color: rgba(51, 51, 51, 0.8); }

kbd { font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace; display: inline-block; color: rgba(0, 0, 0, 0.8); font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: rgba(0, 0, 0, 0.8); }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

p a > code:hover { color: rgba(0, 0, 0, 0.9); }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: rgba(0, 0, 0, 0.85); margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #ddddd8; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #ddddd8; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #ddddd8; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: rgba(0, 0, 0, 0.6); display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: rgba(0, 0, 0, 0.85); }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: rgba(0, 0, 0, 0.85); }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: rgba(0, 0, 0, 0.85); border-bottom: 1px solid #ddddd8; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 1px solid #efefed; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Open Sans", "DejaVu Sans", sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #7a2518; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f8f8f7; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #efefed; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #efefed; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f8f8f7; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: rgba(0, 0, 0, 0.8); padding: 1.25em; }

#footer-text { color: rgba(255, 255, 255, 0.8); line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #efefed; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #ba3925; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #a53221; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; font-family: "Noto Serif", "DejaVu Serif", serif; font-size: 1rem; font-style: italic; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: rgba(0, 0, 0, 0.85); }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Open Sans", "DejaVu Sans", sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #ddddd8; color: rgba(0, 0, 0, 0.6); }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f8f8f7; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #7a2518; margin-top: 0; text-align: center; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #f7f7f8; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { -webkit-border-radius: 4px; border-radius: 4px; word-wrap: break-word; padding: 1em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #f7f7f8; background-color: rgba(0, 0, 0, 0.9); }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1em; -webkit-border-radius: 4px; border-radius: 4px; }

.listingblock pre.prettyprint { border-width: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.45; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #ddddd8; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: rgba(0, 0, 0, 0.85); font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #7a2518; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid rgba(0, 0, 0, 0.6); }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: rgba(0, 0, 0, 0.85); font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.9375em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: rgba(0, 0, 0, 0.6); }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dedede; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.6; background: #f7f8f7; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: rgba(0, 0, 0, 0.8); font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1em; font-size: 0.85em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { width: 1em; position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 1.25em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.05em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #19407c; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: rgba(0, 0, 0, 0.8); -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

dt, th.tableblock, td.content, div.footnote { text-rendering: optimizeLegibility; }

h1, h2, p, td.content, span.alt { letter-spacing: -0.01em; }

p strong, td.content strong, div.footnote strong { letter-spacing: -0.005em; }

p, blockquote, dt, td.content, span.alt { font-size: 1.0625rem; }

p { margin-bottom: 1.25rem; }

.sidebarblock p, .sidebarblock dt, .sidebarblock td.content, p.tableblock { font-size: 1em; }

.exampleblock > .content { background-color: #fffef7; border-color: #e0e0dc; -webkit-box-shadow: 0 1px 4px #e0e0dc; box-shadow: 0 1px 4px #e0e0dc; }

pre > code { font-size: 0.8em; line-height: 1; }

.print-only { display: none !important; }

@media print { @page { margin: 1.25cm 0.75cm; }
  * { -webkit-box-shadow: none !important; box-shadow: none !important; text-shadow: none !important; }
  a { color: inherit !important; text-decoration: underline !important; }
  a.bare, a[href^="#"], a[href^="mailto:"] { text-decoration: none !important; }
  a[href^="http:"]:not(.bare):after, a[href^="https:"]:not(.bare):after { content: "(" attr(href) ")"; display: inline-block; font-size: 0.875em; padding-left: 0.25em; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  pre, blockquote, tr, img, object, svg { page-break-inside: avoid; }
  thead { display: table-header-group; }
  svg { max-width: 100%; }
  p, blockquote, dt, td.content { font-size: 1em; orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  #toc, .sidebarblock, .exampleblock > .content { background: none !important; }
  #toc { border-bottom: 1px solid #ddddd8 !important; padding-bottom: 0 !important; }
  .sect1 { padding-bottom: 0 !important; }
  .sect1 + .sect1 { border: 0 !important; }
  #header > h1:first-child { margin-top: 1.25rem; }
  body.book #header { text-align: center; }
  body.book #header > h1:first-child { border: 0 !important; margin: 2.5em 0 1em 0; }
  body.book #header .details { border: 0 !important; display: block; padding: 0 !important; }
  body.book #header .details span:first-child { margin-left: 0 !important; }
  body.book #header .details br { display: block; }
  body.book #header .details br + span:before { content: none !important; }
  body.book #toc { border: 0 !important; text-align: left !important; padding: 0 !important; margin: 0 !important; }
  body.book #toc, body.book #preamble, body.book h1.sect0, body.book .sect1 > h2 { page-break-before: always; }
  .listingblock code[data-lang]:before { display: block; }
  #footer { background: none !important; padding: 0 0.9375em; }
  #footer-text { color: rgba(0, 0, 0, 0.6) !important; font-size: 0.9em; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Across framework</h1>
<div class="details">
<span id="author" class="author">Arne Vandamme, Marc Vanbrabant, Andy Debrouwer</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_what_s_new_in_this_version">What&#8217;s new in this version?</a>
<ul class="sectlevel2">
<li><a href="#_1_1_2_release">1.1.2.RELEASE</a></li>
<li><a href="#_1_1_1_release">1.1.1.RELEASE</a></li>
</ul>
</li>
<li><a href="#_across_in_a_nutshell">Across in a nutshell</a></li>
<li><a href="#_i_about_across">I. About Across</a>
<ul class="sectlevel1">
<li><a href="#_before_you_begin">1. Before you begin</a></li>
<li><a href="#_modular_development">2. Modular development</a>
<ul class="sectlevel2">
<li><a href="#across-standard-modules">2.1. Across standard modules</a></li>
<li><a href="#across-platform">2.2. Across platform</a></li>
</ul>
</li>
<li><a href="#_core_concepts">3. Core concepts</a></li>
<li><a href="#_across_framework_artifacts">4. Across framework artifacts</a></li>
</ul>
</li>
<li><a href="#across-core">II. Across Core</a>
<ul class="sectlevel1">
<li><a href="#_configuring_an_acrosscontext">5. Configuring an AcrossContext</a>
<ul class="sectlevel2">
<li><a href="#enableacrosscontext">5.1. @EnableAcrossContext</a></li>
</ul>
</li>
<li><a href="#_module_configuration">6. Module configuration</a></li>
<li><a href="#across-bootstrap-order">7. TODO: Across Bootstrap order</a></li>
<li><a href="#_properties">8. Properties</a></li>
<li><a href="#across-datasource">9. TODO: Across datasource</a></li>
<li><a href="#_events_2">10. Events</a></li>
<li><a href="#_todo_refreshable_beans">11. TODO: Refreshable beans</a>
<ul class="sectlevel2">
<li><a href="#_refreshableregistry">11.1. RefreshableRegistry</a></li>
</ul>
</li>
<li><a href="#ordering-beans">12. Ordering beans</a></li>
<li><a href="#development-mode">13. Development mode</a></li>
<li><a href="#_todo_default_beans">14. TODO: Default beans</a>
<ul class="sectlevel2">
<li><a href="#_acrosscontextinfo">14.1. AcrossContextInfo</a></li>
<li><a href="#_acrosscontextbeanregistry">14.2. AcrossContextBeanRegistry</a></li>
<li><a href="#_acrossinstallerrepository">14.3. AcrossInstallerRepository</a></li>
<li><a href="#_conversionservice">14.4. ConversionService</a></li>
<li><a href="#_distributedlockrepository">14.5. DistributedLockRepository</a></li>
<li><a href="#_acrossdevelopmentmode">14.6. AcrossDevelopmentMode</a></li>
</ul>
</li>
<li><a href="#_developing_modules">15. Developing modules</a>
<ul class="sectlevel2">
<li><a href="#creating-an-acrossmodule">15.1. Creating an AcrossModule</a></li>
<li><a href="#_todo_module_settings">15.2. TODO: Module settings</a></li>
<li><a href="#_module_dependencies_2">15.3. Module dependencies</a></li>
<li><a href="#_bootstrap_interaction">15.4. Bootstrap interaction</a></li>
<li><a href="#_exposing_beans_2">15.5. Exposing beans</a></li>
<li><a href="#_message_sources">15.6. Message sources</a></li>
<li><a href="#_installers_2">15.7. Installers</a></li>
<li><a href="#_module_version_information">15.8. Module version information</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#across-web">III. Across Web</a>
<ul class="sectlevel1">
<li><a href="#_general_information">16. General information</a>
<ul class="sectlevel2">
<li><a href="#_todo_about">16.1. TODO: About</a></li>
<li><a href="#_artifact_2">16.2. Artifact</a></li>
<li><a href="#across-web-module-settings">16.3. Module settings</a></li>
</ul>
</li>
<li><a href="#_todo_web_mvc_coniguration">17. TODO: Web MVC coniguration</a></li>
<li><a href="#_todo_prefixed_handler_mapping">18. TODO: Prefixed handler mapping</a></li>
<li><a href="#_acrosswebmodule_and_conversionservice">19. AcrossWebModule and ConversionService</a></li>
<li><a href="#across-application">20. TODO: @AcrossApplication</a>
<ul class="sectlevel2">
<li><a href="#_embedded_servlet_container">20.1. Embedded servlet container</a></li>
<li><a href="#_dynamic_across_modules">20.2. Dynamic Across modules</a></li>
</ul>
</li>
<li><a href="#multipart-config">21. Multipart support</a></li>
<li><a href="#_static_resources">22. Static resources</a>
<ul class="sectlevel2">
<li><a href="#_conventions">22.1. Conventions</a></li>
<li><a href="#client-side-caching">22.2. Client-side caching</a></li>
<li><a href="#resource-url-versioning">22.3. Resource URL versioning</a></li>
<li><a href="#_webresourceregistry">22.4. WebResourceRegistry</a></li>
</ul>
</li>
<li><a href="#_development_mode_support">23. Development mode support</a></li>
<li><a href="#_todo_jsp_and_thymeleaf_integration">24. TODO: JSP and Thymeleaf integration</a></li>
<li><a href="#_development_mode_support_2">25. Development mode support</a></li>
<li><a href="#web-templates">26. Web templates</a>
<ul class="sectlevel2">
<li><a href="#_creating_a_template">26.1. Creating a template</a></li>
<li><a href="#_linking_a_template_to_a_controller">26.2. Linking a template to a controller</a></li>
<li><a href="#_registering_the_default_template">26.3. Registering the default template</a></li>
</ul>
</li>
<li><a href="#_building_menus">27. Building menus</a></li>
<li><a href="#dynamic-servlet-registration">28. Registering servlets and filters</a></li>
<li><a href="#default-http-encoding">29. Default HTTP encoding</a></li>
<li><a href="#_todo_web_path_resolving">30. TODO: Web path resolving</a></li>
</ul>
</li>
<li><a href="#across-test">IV. Across Test</a>
<ul class="sectlevel1">
<li><a href="#_base_test_classes">31. Base test classes</a>
<ul class="sectlevel2">
<li><a href="#_module_conventions_test">31.1. Module conventions test</a></li>
</ul>
</li>
<li><a href="#test-builders">32. Test context builders</a></li>
<li><a href="#test-annotations">33. Annotations</a>
<ul class="sectlevel2">
<li><a href="#annotation-across-test-configuration">33.1. @AcrossTestConfiguration</a></li>
<li><a href="#acrosswebappconfiguration">33.2. @AcrossWebAppConfiguration</a></li>
</ul>
</li>
<li><a href="#_spring_boot_application_testing">34. Spring Boot Application testing</a>
<ul class="sectlevel2">
<li><a href="#__webintegrationtest">34.1. @WebIntegrationTest</a></li>
<li><a href="#boot-integration-test-mockmvc">34.2. Integration test with MockMvc support</a></li>
</ul>
</li>
<li><a href="#_mock_mvc_integration">35. Mock MVC integration</a></li>
<li><a href="#_testing_dynamic_modules">36. Testing dynamic modules</a></li>
<li><a href="#mock-across-servlet-context">37. MockAcrossServletContext</a></li>
<li><a href="#test-datasources">38. Test datasources</a></li>
</ul>
</li>
<li><a href="#_v_appendices">V. Appendices</a>
<ul class="sectlevel1">
<li><a href="#_advanced_topics">39. Advanced topics</a>
<ul class="sectlevel2">
<li><a href="#_module_resolving">39.1. Module resolving</a></li>
</ul>
</li>
<li><a href="#_conventions_2">40. Conventions</a>
<ul class="sectlevel2">
<li><a href="#module-conventions">40.1. TODO: AcrossModule</a></li>
<li><a href="#_todo_acrossapplication">40.2. TODO: @AcrossApplication</a></li>
</ul>
</li>
<li><a href="#_todo_published_events">41. TODO: Published events</a></li>
<li><a href="#appendix-test-configuration-classes">42. Test configuration classes</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="openblock copyright">
<div class="content">
<div class="paragraph">
<p>Copyright &#169; 2014-2016<br>
<span class="small">Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically.</span></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_s_new_in_this_version"><a class="anchor" href="#_what_s_new_in_this_version"></a>What&#8217;s new in this version?</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_1_1_2_release"><a class="anchor" href="#_1_1_2_release"></a>1.1.2.RELEASE</h3>
<div class="paragraph">
<p><strong>Across Core</strong></p>
</div>
<div class="paragraph">
<p>Across now requires JDK8 and has improved support for Spring Boot.
The latter is also a required dependency as of 1.1.2.
A lot of improvements have been done to reduce the amount of boilerplate code necessary to create a new <code>AcrossContext</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#enableacrosscontext">@EnableAcrossContext</a> annotation now supports autoconfiguration of an <code>AcrossContext</code></p>
</li>
<li>
<p><a href="#moduleconfiguration">@ModuleConfiguration</a> annotation provides a no-hassle way to declare annotated classes that need to be added to a specific module</p>
</li>
<li>
<p>message sources are now <a href="#auto-detecting-message-sources">auto-detected</a> if they follow the conventions</p>
</li>
<li>
<p>both <code>AcrossModule</code> and <code>ModuleBootstrapConfig</code> now have shortcut <code>expose()</code> methods that make it easier to expose additional beans</p>
</li>
<li>
<p>several changes and improvements were made to installers:</p>
<div class="ulist">
<ul>
<li>
<p>installers are now created in their own configurable <a href="#installer-applicationcontext">installer <code>ApplicationContext</code></a></p>
</li>
<li>
<p>installers are detected automatically through classpath scanning (defaults to <strong>installers</strong> package of a module)</p>
</li>
<li>
<p>installers are ordered based on the presence of an <code>@Order</code> annotation</p>
</li>
<li>
<p>installers now support <code>@Conditional</code> annotations for building more complex conditions</p>
</li>
<li>
<p>installers should only be specified as class names in <code>getInstallers()</code>, the use of instances is deprecated</p>
</li>
<li>
<p><code>InstallerSettings</code> has been refactored to use <code>InstallerMetaData</code> instead (breaking change)</p>
</li>
<li>
<p>installers can implement <code>InstallerActionResolver</code> directly to suppress execution at runtime</p>
</li>
<li>
<p><code>AcrossInstallerRepository</code> now has methods to rename installers</p>
</li>
<li>
<p><code>AcrossLiquibaseInstaller</code> detects the most appropriate <code>SchemaConfiguration</code> to use and modifies default schema accordingly</p>
</li>
</ul>
</div>
</li>
<li>
<p>development mode can be set through the property <strong>across.development.active</strong> and is active by default if a Spring profile called <strong>dev</strong> is active</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Across Web</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#across-application">@AcrossApplication</a> can be used with <code>SpringApplication</code> to bootstrap an Across context with dynamic modules and support for embedded servlet containers</p>
</li>
<li>
<p>async configuration can now correctly be set through <code>WebMvcConfigurer#configureAsyncSupport(AsyncSupportConfigurer)</code></p>
</li>
<li>
<p><code>AcrossWebModuleSettings</code> has been refactored and <code>AcrossWebModule</code> can now be <a href="#across-web-module-settings">configured through properties</a></p>
<div class="ulist">
<ul>
<li>
<p>properties support Spring configuration metadata with possible IDE support</p>
</li>
</ul>
</div>
</li>
<li>
<p>by default only Thymeleaf views support is activated (breaking change)</p>
</li>
<li>
<p>static resources now configure default <a href="#client-side-caching">client-side caching</a> and <a href="#resource-url-versioning">resource url versioning</a></p>
</li>
<li>
<p><a href="#dynamic-servlet-registration">dynamic registration of servlets and filters</a> now supports ordering</p>
</li>
<li>
<p><a href="#default-http-encoding">default HTTP encoding</a> is now forced to UTF-8</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Across Test</strong></p>
</div>
<div class="paragraph">
<p>Several improvements have been done for easier integration testing of modules in a web context.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#test-builders">test context builders</a> have been added for easy configuration of an <code>AcrossContext</code> in test methods</p>
</li>
<li>
<p><a href="#mock-across-servlet-context">MockAcrossServletContext</a> can now be used for testing of dynamic <code>ServletContext</code> configuration</p>
</li>
<li>
<p>addition of a <code>AcrossMockMvcBuilders</code> class for creating a <code>MockMvcBuilder</code> based on an <code>AcrossContext</code></p>
<div class="ulist">
<ul>
<li>
<p>both <a href="#test-annotations">annotations</a> and <a href="#test-builders">builders</a> now provide a singleton <code>MockMvc</code> instance that is initialized with the bootstrapped context and all dynamically registered filters</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_1_1_1_release"><a class="anchor" href="#_1_1_1_release"></a>1.1.1.RELEASE</h3>
<div class="paragraph">
<p>Initial public release available on <a href="http://search.maven.org/">Maven central</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_across_in_a_nutshell"><a class="anchor" href="#_across_in_a_nutshell"></a>Across in a nutshell</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Across is a Java framework that aims to facilitate module based development for Java (web) applications.
It builds heavily on Spring framework and allows defining a module consisting of a number of classes and configuration files.
Every module defines its own Spring application context and can share one or more beans with other modules.</p>
</div>
<div class="paragraph">
<p>Across modules can contain any set of functionality: low-level add-ons like facilities to activate caching or end user
functionality including web controllers and their views.  Across provides the basic infrastructure to define modules and
make them depend on each other.  A module will most often be a separate jar, but this is in no way a requirement.</p>
</div>
<div class="paragraph">
<p>The general principle is that every Across module can depend on others, but is responsible for its own installation and
start-up procedures.  To this end, a module can define its own installers.</p>
</div>
<div class="paragraph">
<div class="title">Getting started</div>
<p>This is the reference documentation,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>release overview</p>
</li>
<li>
<p>samples and tutorials</p>
</li>
<li>
<p>appendices list events and overview of conventions</p>
</li>
</ul>
</div>
</div>
</div>
<h1 id="_i_about_across" class="sect0"><a class="anchor" href="#_i_about_across"></a>I. About Across</h1>
<div class="sect1">
<h2 id="_before_you_begin"><a class="anchor" href="#_before_you_begin"></a>1. Before you begin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To understand what Across is and how it works you should have good knowledge of Java web development as well as
<a href="http://projects.spring.io/spring-framework/">Spring framework and Spring Web MVC</a>.  At the very least you should be familiar with the concepts of dependency
injection (auto-wiring), the <code>ApplicationContext</code> and <code>JavaConfig</code> configuration style.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_modular_development"><a class="anchor" href="#_modular_development"></a>2. Modular development</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Across framework aims to facilitate module based development of your Java applications.  An application would simply
 consist of a collection of modules, where each module brings a set of functionality to the table.  Modules are somewhat
 <em>knowledgeable</em>, they <em>know</em> about the application/set-up they are running in and can make decisions based on that
 knowledge.  They know about other modules and the services they provide, and they are able to talk to those other
 modules to provide automatic integration.</p>
</div>
<div class="paragraph">
<p>Well defined modules can offload work from the developer.  The development team does not need to make the same decisions
 over and over again for every new application.  With a well defined module it needs to be made only once, and in new
 applications the same module will make the same reliable decision.</p>
</div>
<div class="paragraph">
<p>For modules to be able to do this they have to speak a common language.  In software development terms this means they
 need to implement a same contract (usually in the form of interfaces or base classes).  Providing that common language
 is what Across framework is about.</p>
</div>
<div class="paragraph">
<p>Across framework gives developers an easy way to create, configure and reuse <em>smart</em> modules.</p>
</div>
<h3 id="_the_difference_between_libraries_and_modules" class="discrete">The difference between libraries and modules</h3>
<div class="paragraph">
<p>The terms <em>libraries</em> and <em>modules</em> are sometimes used interchangeably in the software development landscape.  The exact
 meaning depends on the context.  When talking about Across we identify the following difference between the two:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">A library</dt>
<dd>
<p>Provides a set of low-level building blocks, infrastructure that can be used to build application logic.  Libraries are
<em>dumb</em>, they only do exactly as they have been told by a developer.<br></p>
<div class="paragraph">
<p>In a car analogy libraries could be <em>wheels</em> and <em>frames</em>.  Someone - a developer - would still need to decide how to assemble
 the different components to achieve an actual car.</p>
</div>
<div class="paragraph">
<p>In this context <a href="http://commons.apache.org/">Apache Commons</a> is a library, but so is <a href="http://projects.spring.io/spring-framework/">Spring framework</a>
as well as the <a href="#across-core">II. Across Core</a> itself.</p>
</div>
</dd>
<dt class="hdlist1">A module</dt>
<dd>
<p>Provides more high-level building blocks in the form of complete functionality requiring little or even no
configuration.  Even with just a few modules present you could get a fully functional application.  Modules are <em>smart</em>,
they can make decisions based on their knowledge of the environment they are running in.<br></p>
<div class="paragraph">
<p>In the car analogy a module could in fact be an entire car.  The car knows how to drive, it knows it has four wheels
 and knows the state of every one of them.  Configuration of the module could be the decision of the engine you&#8217;d want.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>As to deciding whether you want a module or a library, think of it this way: are you required to build a car,
or is your mission to travel from A to B and you simply need a car to be able to do so?</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>In all Across documentation we refer to a <strong>module</strong> as an implementation of an <code>AcrossModule</code> that provides
a set of functionality out of the box.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="across-standard-modules"><a class="anchor" href="#across-standard-modules"></a>2.1. Across standard modules</h3>
<div class="paragraph">
<p>Apart from the Across framework itself, a different project maintains a set of Across standard modules.  These modules aim
 to be productivity enhancers by providing you with a common set of functionality that can be used as the foundation
 for your applications or even for an entire web cms.</p>
</div>
<div class="paragraph">
<p>There are standard modules that provide you with the set-up for an administrative web interface, secured with
 <a href="http://projects.spring.io/spring-security/">Spring security</a> and built on top of an entire roles and permissions management domain layer.
 Other modules generate web forms at runtime for persistent entities you have declared in your application.</p>
</div>
<div class="paragraph">
<p>Across framework provides only a ground layer, the real win is in re-using well-defined modules that have already
been built.  The standard modules projects aims to do exactly that: bring some best of breed modules to the open source Across landscape.</p>
</div>
</div>
<div class="sect2">
<h3 id="across-platform"><a class="anchor" href="#across-platform"></a>2.2. Across platform</h3>
<div class="paragraph">
<p>Across platform provides a single BOM pom that has a curated list of dependencies for both Across core and Across Standard Modules.
Using the platform is advised for Across based applications as the platform will ensure different module versions play together nicely.</p>
</div>
<h3 id="_across_and_spring_framework" class="discrete">Across and Spring framework</h3>
<div class="paragraph">
<p><a href="http://projects.spring.io/spring-framework/">Spring framework</a> is a de facto industry standard for building Java (web) applications.  It was a logical
 choice to use it as the foundation for Across.  Across extends or even customizes some aspects of Spring, but still supports
 most if not all common Spring functions out of the box.  To use Across optimally, a good knowledge of Spring is required.</p>
</div>
<div class="paragraph">
<p><a href="#across-core">II. Across Core</a> and <a href="#across-web">III. Across Web</a> build on top of the common Spring framework, while other <a href="#across-standard-modules">standard modules</a> integrate different
Spring libraries like <a href="http://projects.spring.io/spring-data/">Spring Data</a>, <a href="http://projects.spring.io/spring-batch/">Spring Batch</a> or <a href="http://projects.spring.io/spring-security/">Spring security</a>.</p>
</div>
<h3 id="_across_and_osgi" class="discrete">Across and OSGi</h3>
<div class="paragraph">
<p>While Across talks about modules just like OSGi does and some similarity between the basic concepts can be found,
 there is currently no relation between the two.  Across modules are not OSGi and the current development does not
 involve developing and testing for OSGi containers.</p>
</div>
<div class="paragraph">
<p>The focus of Across is more on providing a way to group end-user functionality than it is on a dynamic runtime environment.
Integrating Across applications in the OSGi landscape is on the long-term roadmap.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_core_concepts"><a class="anchor" href="#_core_concepts"></a>3. Core concepts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>At the heart of Across are a couple of concepts you should understand.  The terms related tot these concepts are used
throughout all Across documentation, consider them part of the Across <a href="http://en.wikipedia.org/wiki/Domain-specific_language">DSL</a>.</p>
</div>
<h3 id="_across_context" class="discrete">Across context</h3>
<div class="paragraph">
<p>An Across context is a configured set of Across modules and usually represents a single application.
A single Across context is represented by the <code>AcrossContext</code> class but usually created by using <a href="#yrdy"><code>@EnableAcrossContext</code></a> or <a href="#yrer"><code>@AcrossApplication</code></a>.</p>
</div>
<div class="paragraph">
<p>Compared to a single Spring <code>ApplicationContext</code>, an <code>AcrossContext</code> represents an entire hierarchy of <code>ApplicationContext</code> instances.
The <code>AcrossContext</code> itself is an <code>ApplicationContext</code> that can have optionally have a parent <code>ApplicationContext</code>.
However every single module loaded in the Across context also is a separate <code>ApplicationContext</code> with the Across context as parent.</p>
</div>
<h3 id="_across_module" class="discrete">Across module</h3>
<div class="paragraph">
<p>An Across module represents a grouped set of beans and services that provide application logic and that often other modules can use.
Every module is uniquely identified by its name and is defined by <a href="#creating a descriptor class">[creating a descriptor class]</a> that extends from the <code>AcrossModule</code> class.</p>
</div>
<div class="paragraph">
<p>The <code>AcrossModule</code> implementation defines how the module contents should be loaded in the Across context.
If a module adheres to a set of <a href="#conventions">[conventions]</a>, required configuration can be kept at a minimum.
For simple applications, it is even possible to define <a href="#package based dynamic modules">[package based dynamic modules]</a> that require no separate descriptor.</p>
</div>
<h3 id="_module_dependencies" class="discrete">Module dependencies</h3>
<div class="paragraph">
<p>Modules can depend on other modules.
If module B depends on module A, B states explicitly that it wishes to make use of the functionality that A will provide.
The module dependencies will determine the loading order of the modules in the configured Across context.</p>
</div>
<div class="paragraph">
<p>Modules have two types of dependencies on other modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>explicit dependencies usually configured with &lt;&lt;`@AcrossDepends`&gt;&gt;</p>
</li>
<li>
<p>implicit dependencies defined by the <a href="#module role">[module role]</a></p>
</li>
</ul>
</div>
<h3 id="_bootstrapping" class="discrete">Bootstrapping</h3>
<div class="paragraph">
<p>An Across context is configured by dermining which modules should be loaded.
The actual creation of the module beans is only done when the Across context <a href="#bootstraps">[bootstraps]</a>.
Bootstrapping an Across context involves the creation of the backing Spring <code>ApplicationContext</code> instances.
Every single module will have an <code>ApplicationContext</code> configured according to the <code>AcrossModule</code> descriptor.
During bootstrapping, all modules are bootstrapped sequentially and in the order determined through their dependencies.</p>
</div>
<div class="paragraph">
<p>An <code>AcrossContext</code> is only successfully bootstrapped if all modules have bootstrapped successfully.
A general <code>AcrossContext</code> and <code>AcrossModule</code> lifecycle has a start (bootstrap) and stop (shutdown) phase.
In most applications these are managed transparently through the use of <code>@EnableAcrossContext</code> or <code>@AcrossApplication</code>.</p>
</div>
<h3 id="_installers" class="discrete">Installers</h3>
<div class="paragraph">
<p>An Across module can define any number of installer beans.
Installers are special beans that will only exist:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>during the bootstrapping of the Across context</p>
</li>
<li>
<p>if all conditions for the installers apply</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Installers can be used to setup the necessary infrastructure for the services that a module provides.
Common use cases for installers include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>installing a database schema</p>
</li>
<li>
<p>inserting (test) data</p>
</li>
<li>
<p>running migration tasks</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Across itself provides the mechanism for defining installers and optimizing (conditional) installer execution.</p>
</div>
<h3 id="_exposing_beans" class="discrete">Exposing beans</h3>
<div class="paragraph">
<p>Module B can only use a service of module A if module A has explicitly exposed that service.
A service is usually provided through one or more beans, so that means that module A must expose those beans to its owning Across context.
If that has been done, beans from module B can simply wire the beans from module A directly.
Exposing is the means through which module collaboration is defined.</p>
</div>
<h3 id="_events" class="discrete">Events</h3>
<div class="paragraph">
<p>An Across context creates a central event bus that every module has access to.
Any bean can publish events on the bus, and special listeners can catch and handle the events published.</p>
</div>
<div class="paragraph">
<p>Using events is a common way for modules to provide extensions points to other modules, without forcing dependencies.</p>
</div>
<h3 id="_refreshing_beans" class="discrete">Refreshing beans</h3>
<div class="paragraph">
<p>Sometimes it is not possible to define explicit dependencies between modules.
For example where module B depends on module A but creates a bean that A should use.
Because circular dependencies are not allowed the only solution for this would be to use <a href="#refreshable beans">[refreshable beans]</a>.</p>
</div>
<div class="paragraph">
<p>Specially demarcated beans can be refreshed after the entire Across context has finished bootstrapped.
These beans will have their dependencies updated based on the now fully populated <code>AcrossContext</code>.
The valid use cases for refreshable beans are limited, and if unsure explicit dependencies or the use of events is preferred.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_across_framework_artifacts"><a class="anchor" href="#_across_framework_artifacts"></a>4. Across framework artifacts</h2>
<div class="sectionbody">
<h3 id="_overview" class="discrete">Overview</h3>
<div class="paragraph">
<p>Across framework itself consists of 3 library artifacts (<code>across-core</code>, <code>across-web</code> and <code>across-test</code>) and one bill-of-material pom (<code>standard-module-bom</code>).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">across-core</dt>
<dd>
<p>Supports the configuration of an Across context and provides all necessary infrastructure to define and execute modules.</p>
</dd>
<dt class="hdlist1">across-web</dt>
<dd>
<p>Provides an <code>AcrossModule</code> that supports configuration of a web application using Across with the Spring <code>DispatcherServlet</code> as the most common scenario.</p>
</dd>
<dt class="hdlist1">across-test</dt>
<dd>
<p>Supports integration testing of your Across modules, both web and non-web related.  Builds on top of <code>spring-test</code>.</p>
</dd>
<dt class="hdlist1">standard-module-bom</dt>
<dd>
<p>BOM pom for creating an Across Standard Module or any module wishing to adhere to the standard module conventions.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>There is also a separate <a href="https://foreach.atlassian.net/wiki/display/AX/Across+Platform">platform-bom</a> project that provides a bill-of-material for applications built on Across and the Across Standard Modules.</p>
</div>
<h3 id="_common_dependencies" class="discrete">Common dependencies</h3>
<div class="paragraph">
<p>Across is directly tied to Spring framework and all artifacts come with a set of curated dependencies.
Across itself uses the Spring Platform as a basis for all its dependencies.</p>
</div>
<h3 id="_repository" class="discrete">Repository</h3>
<div class="paragraph">
<p>All Across related artifacts - both release and snapshot versions - can be fetched from the Foreach Nexus repository.  This also includes the set of <a href="#across-standard-modules">Across standard modules</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;repositories&gt;
    &lt;repository&gt;
        &lt;id&gt;foreach-nexus&lt;/id&gt;
        &lt;name&gt;Foreach nexus&lt;/name&gt;
        &lt;url&gt;http://repository.foreach.be/nexus/content/groups/public/&lt;/url&gt;
    &lt;/repository&gt;
&lt;/repositories&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Release version are also available in Maven Central.</p>
</div>
</div>
</div>
<h1 id="across-core" class="sect0"><a class="anchor" href="#across-core"></a>II. Across Core</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Across Core is the main dependency that is required for bootstrapping an <code>AcrossContext</code>.</p>
</div>
<h2 id="_artifact" class="discrete">Artifact</h2>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.foreach.across&lt;/groupId&gt;
        &lt;artifactId&gt;across-core&lt;/artifactId&gt;
        &lt;version&gt;1.1.2.RELEASE&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_an_acrosscontext"><a class="anchor" href="#_configuring_an_acrosscontext"></a>5. Configuring an AcrossContext</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="enableacrosscontext"><a class="anchor" href="#enableacrosscontext"></a>5.1. @EnableAcrossContext</h3>
<div class="paragraph">
<p>Usually your application will consist of a single <code>AcrossContext</code> that is configured in the main Spring <code>ApplicationContext</code>.
You can enable the automatic creation of an <code>AcrossContext</code> by putting the <code>@EnableAcrossContext</code> on any <code>@Configuration</code> class.
This will initialize a new <code>AcrossContext</code> with the main <code>ApplicationContext</code> as parent, look for a <a href="#across-datasource">default datasource bean</a> named <strong>acrossDataSource</strong> and then configure modules based on the <code>@EnableAcrossContext</code> attribute values.</p>
</div>
<div class="sect3">
<h4 id="_acrosscontext_autoconfiguration"><a class="anchor" href="#_acrosscontext_autoconfiguration"></a>5.1.1. AcrossContext autoconfiguration</h4>
<div class="paragraph">
<p>By default autoconfiguration of the <code>AcrossContext</code> will be enabled.
This implies that all <code>AcrossModule</code> beans from the parent <code>ApplicationContext</code> will be configured, along with any modules specified by name on <code>@EnableAcrossContext</code>.</p>
</div>
<div class="paragraph">
<p>When autoconfiguration is enabled, packages will be scanned to find valid module classes.
Unless packages are configured manually using the <strong>modulePackages</strong> or <strong>modulePackageClasses</strong> attributes, the <em>com.foreach.across.modules</em> package along with the package of the declaring <code>@Configuration</code> class will be scanned.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you use <code>@EnableAcrossContext</code> on a top-level class (no package specified), package <em>modules</em> and <em>com.foreach.across.modules</em> will be used for default scanning.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Scanning for modules in itself does not add any modules to the <code>AcrossContext</code>.
It simply maps all modules that could be autoconfigured on their unique name.
For a module to be autoconfigurable it should adhere to certain conventions, see the section on <a href="#creating-an-acrossmodule">creating an Across module</a> for more details.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The module scanning packages and settings can be controlled through attributes on <code>@EnableAcrossContext</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
A module name should be unique.
If you have more than one module with the same name, the last module scanned will take precedence.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Minimal example of using @EnableAcrossContext</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">/**
 * Minimal configuration that will attempt to resolve module MyCustomModule:
 * - in the standard modules package (com.foreach.across.modules)
 * - in the package that AppConfiguration belongs to
 *
 * If found, MyCustomModule and its required dependencies will be added to the AcrossContext.
 * If not found, AcrossContext bootstrapping will fail.
 */
@Configuration
@EnableAcrossContext( "MyCustomModule" )
public class AppConfiguration
{
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to customize the module configuration or a module is not autoconfigurable, you can add it as a bean in the parent <code>ApplicationContext</code> instead.</p>
</div>
<div class="listingblock">
<div class="title">Example adding a module as a bean</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">/**
 * AcrossWebModule is added to the AcrossContext by name.
 *
 * MyCustomModule is added as a bean in the ApplicationContext.
 * Because the bean implements AcrossModule, it will also be added to the AcrossContext.
 *
 * All required dependencies of either module will also be added if they can be found through scanning.
 */
@Configuration
@EnableAcrossContext( AcrossWebModule.NAME )
public class AppConfiguration
{
    @Bean
    public MyCustomModule myCustomModule() {
        return new MyCustomModule();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As the previous example shows, you can safely combine beans and named module configuration.
Modules are configured in a certain order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Modules defined by name on <code>@EnableAcrossContext</code></p>
</li>
<li>
<p>Module beans detected in the <code>ApplicationContext</code></p>
</li>
<li>
<p>Modules added through <a href="#acrosscontextconfigurer"><code>AcrossContextConfigurer</code> instances</a></p>
</li>
<li>
<p>Missing module dependencies resolved during bootstrap</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If a module with the same name gets added more than once, the last version added will always win.</p>
</div>
</div>
<div class="sect3">
<h4 id="acrosscontextconfigurer"><a class="anchor" href="#acrosscontextconfigurer"></a>5.1.2. Customizing the AcrossContext</h4>
<div class="paragraph">
<p>After initial configuration but before bootstrapping, the configured <code>AcrossContext</code> will be delegated to all <code>AcrossContextConfigurer</code> beans it can find in the <code>ApplicationContext</code>.
This allows for changing any settings before the actual bootstrap happens.</p>
</div>
<div class="listingblock">
<div class="title">Example customizing an AcrossContext</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableAcrossContext
public class WebConfiguration implements AcrossContextConfigurer
{
	@Bean
	public DataSource acrossDataSource() {
		BasicDataSource dataSource = new BasicDataSource();
		dataSource.setDriverClassName( "org.hsqldb.jdbc.JDBCDriver" );
		dataSource.setUrl( "jdbc:hsqldb:mem:/hsql/testDataSource" );
		dataSource.setUsername( "sa" );
		dataSource.setPassword( "" );

		return dataSource;
	}

	@Override
	public void configure( AcrossContext context ) {
		context.setDevelopmentMode( true );

		context.addModule( new SomeModule() );
	}
}</code></pre>
</div>
</div>
<h3 id="_manual_configuration" class="discrete">Manual configuration</h3>
<div class="paragraph">
<p>An <code>AcrossContext</code> can be also configured manually and is started using the <code>bootstrap()</code> method, and stopped using <code>shutdown()</code>.
These methods take care of the Spring <code>ApplicationContext</code> lifecycle of all modules configured in the context.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">AcrossContext context = new AcrossContext();
context.setParentApplicationContext( optionalParentContext );
context.setDataSource( someDataSource );
context.addModule( new SomeModule() );

// Start the context
context.bootstrap();

// Stop the context
context.shutdown();</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_module_configuration"><a class="anchor" href="#_module_configuration"></a>6. Module configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Apart from module settings, an application can also define a number of <code><a href="#moduleconfiguration">@ModuleConfiguration</a></code> classes to be added to the bootstrapping modules.
When using the <code>@EnableAcrossContext</code>, the packages to scan for these can be set using attributes, but by default the sub-packages <strong>config</strong> and <strong>extensions</strong> of the importing class will be used.</p>
</div>
<div class="paragraph">
<p>Alternatively the packages to scan can be controlled via the <code>moduleConfigurationScanPackages</code> property on <code>AcrossContext</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="across-bootstrap-order"><a class="anchor" href="#across-bootstrap-order"></a>7. TODO: Across Bootstrap order</h2>
<div class="sectionbody">
<div class="paragraph">
<p>order modules based on dependencies
run installers in the different phases
publish events</p>
</div>
<div class="paragraph">
<p>prepareForBootstrap
AcrossBootstrapConfig / ModuleBootstrapConfig
extendModule
AcrossContextInfo and AcrossModuleInfo - modifying bootstrap configuration from within a module</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_properties"><a class="anchor" href="#_properties"></a>8. Properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Both AcrossModule and AcrossContext have a collection of Properties.
These can be accessed directly from the instance, but will also be registered as <code>PropertySource</code> in the bootstrapping <code>ApplicationContext</code>.
Across favours the PropertySource/Environment approach over the concept of multiple PropertyPlaceholderConfigurer.
Reasoning behind this is <a href="https://jira.spring.io/browse/SPR-8539?focusedCommentId=75569&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-75569">explained here as a comment on a Spring issue</a>.</p>
</div>
<h3 id="_registering_additional_propertysources" class="discrete">Registering additional PropertySources</h3>
<div class="paragraph">
<p>Apart from the Properties directly on AcrossModule and AcrossContext instances, there are methods to register additional PropertySources to a module or context.
PropertySources or properties configured on a module, will only be available within that module; whereas PropertySources or properties on the context will be available in all modules.
Because PropertySource is most often based on an actual Resource file, the addPropertySources() methods allow direct usage of Resource instances.
If the Resource does not exist, it is simply ignored.</p>
</div>
<h3 id="_propertysource_priority" class="discrete">PropertySource priority</h3>
<div class="paragraph">
<p>Within the context or module, the order in which PropertySources have been registered determines the order of looking for the property values.
In a context/module hierarchy, the following order is used:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>properties set directly on the current AcrossModule</p>
</li>
<li>
<p>PropertySources attached to the current AcrossModule (last one added first)</p>
</li>
<li>
<p>properties set directly on the AcrossContext</p>
</li>
<li>
<p>PropertySources attached to the AcrossContext (last one added first)</p>
</li>
<li>
<p>PropertySources registered in the parent ApplicationContext</p>
</li>
</ol>
</div>
<h3 id="_accessing_properties_in_modules" class="discrete">Accessing properties in modules</h3>
<div class="paragraph">
<p>Accessing properties in modules is no different than in standard Spring.
By default all properties can be accessed using the Environment.</p>
</div>
<div class="listingblock">
<div class="title">Example using Environment</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
public class Config
{
    @Bean
    public AcrossContext acrossContext( ConfigurableApplicationContext applicationContext ) throws Exception {
        AcrossContext context = new AcrossContext( applicationContext );
        context.setDataSource( acrossDataSource() );
        context.setAllowInstallers( true );

        // Configure some properties
        context.setProperty( "directProperty", 789 );
        context.addPropertySources( new ClassPathResource("my.properties") );

        context.addModule( testModule1() );
        context.addModule( testModule2() );
        return context;
    }
}

@Configuration
public class ConfigInModule{
    @Autowired
    private Environment environment;

    @Bean
    public MyBean myBean() {
        return new MyBean( environment.getProperty( "my.property" ) );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to use placeholders you must add a PropertySourcesPlaceholderConfigurer to every module where you want placeholders to be resolved.
Because of the way BeanFactoryPostProcessors and PropertyPlaceholderConfigurers work, it is best to configure a new instance in every module, instead of passing a shared postprocessor to all modules.
A default ApplicationContextConfigurer is available in the PropertyPlaceholderSupportConfigurer class.
In practice however: it should be the responsibility of the module to configure a PropertyPlaceholderConfigurer if it uses placeholders!</p>
</div>
<div class="listingblock">
<div class="title">Example using PropertySources and simple property placeholder resolving</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
public class Config
{
    @Bean
    public AcrossContext acrossContext( ConfigurableApplicationContext applicationContext ) throws Exception {
        AcrossContext context = new AcrossContext( applicationContext );
        context.setDataSource( acrossDataSource() );
        context.setAllowInstallers( true );

        // Configure some properties
        context.setProperty( "directProperty", 789 );
        context.addPropertySources( new ClassPathResource("my.properties") );

        // Register the property placeholder resolving in every module
        context.addApplicationContextConfigurer( new PropertyPlaceholderSupportConfigurer(),
                                                 ConfigurerScope.CONTEXT_AND_MODULES );

        context.addModule( testModule1() );
        context.addModule( testModule2() );
        return context;
    }
}

@Configuration
public class ConfigInModule {
    @Bean
    public MyBean myBean( @Value("${my.property}") String myProperty ) {
        return new MyBean( environment.getProperty( myProperty  ) );
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example using custom property placeholder resolving</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// Import inner class to make resolver available both in parent as in Across context
@Configuration
@Import(CustomPropertyConfig.class)
public class Config
{
    @Configuration
    public static class CustomPropertyConfig
    {
        @Bean
        public static PropertySourcesPlaceholderConfigurer properties() {
            PropertySourcesPlaceholderConfigurer configurer = new PropertySourcesPlaceholderConfigurer();
            configurer.setLocation( new ClassPathResource( "my.properties" ) );
            return configurer;
        }
    }

    @Bean
    public AcrossContext acrossContext( ConfigurableApplicationContext applicationContext ) throws Exception {
        AcrossContext context = new AcrossContext( applicationContext );
        context.setDataSource( acrossDataSource() );
        context.setAllowInstallers( true );

        // Register the property placeholder resolving in every module
        context.addApplicationContextConfigurer( new AnnotatedClassConfigurer( CustomPropertyConfig.class ),
                                                 ConfigurerScope.CONTEXT_AND_MODULES );


        context.addModule( testModule1() );
        context.addModule( testModule2() );
        return context;
    }
}

@Component
public class SomeBeanInModule {
    @Value("${my.property}")
    private String someValueFromProperty;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="across-datasource"><a class="anchor" href="#across-datasource"></a>9. TODO: Across datasource</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An AcrossContext supports the configuration of a DataSource instance.
The datasource will be available for all modules as bean named <strong>acrossDataSource</strong>.
Additionally a second datasource can be configured that will be available as the <strong>acrossInstallerDataSource</strong>.
If no separate installer datasource is specified, the default across datasource will be used.</p>
</div>
<div class="paragraph">
<p>TODO: if you want to run installers, you need a datasource (distributedlock repository, installer tracking)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_events_2"><a class="anchor" href="#_events_2"></a>10. Events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every Across context creates an AcrossEventPublisher bean.
This bean can be wired in any module to dispatch events.
The default implementation of the event publisher uses MBassador.</p>
</div>
<h3 id="_publishing_events" class="discrete">Publishing events</h3>
<div class="paragraph">
<p>Publishing an event can be done from anywhere by simply creating an instance of the AcrossEvent interface.
This is a marker interface not defining any additional methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public static class SomeEvent implements AcrossEvent {
}

@Autowired
private AcrossEventPublisher eventBus;

public void sendEvent() {
  eventBus.publish( new SomeEvent() );
}</code></pre>
</div>
</div>
<h3 id="_subscribing_to_events" class="discrete">Subscribing to events</h3>
<div class="paragraph">
<p>Event handlers must not implement any special interface, event handler methods must declare themselves as handling an event by specifying the @Event annotation.
A single event handler bean can have many handler methods, all event handler beans must be added to the AcrossEventPublisher however.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Autowired
private AcrossEventPublisher eventBus;

@PostConstruct
public void listen() {
    // Subscribe ourselves to the event bus
    eventBus.subscribe( this );
}

@Event
public void handle( SomeEvent event ) {
    // Called whenever an event of type SomeEvent is published
}</code></pre>
</div>
</div>
<h3 id="_auto_detecting_event_handlers" class="discrete">Auto-detecting event handlers</h3>
<div class="paragraph">
<p>Some beans are automatically scanned for handler methods, these are all beans annotated with @Controller or @AcrossEventHandler.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Component
@AcrossEventHandler
public class MyHandler {
    @Event
    public void handle( SomeEvent event ) {
        // Called whenever an event of type SomeEvent is published
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Take special care when combining AOP with event handlers, as the event publisher only has limited support for AOP proxies.
Depending on the strategy used (CGlib or JDK proxy) the actual proxy (CGlib) or the proxy target (in case of JDK proxy) will be registered as the event handler.
In the latter case the event will still be fired but the actual handle method will not be intercepted.
</td>
</tr>
</table>
</div>
<h3 id="_filtering_events" class="discrete">Filtering events</h3>
<div class="paragraph">
<p>Depending on the interface an event implements a handler can be specific about which events it wants to receive.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Event implements</th>
<th class="tableblock halign-left valign-top">Filtering</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AcrossEvent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is only done on the class of the event. All instances of the specific event class (or subclasses) will be handled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NamedAcrossEvent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is done on the class of the event as well as the name of the event if an @EventName annotation is present on the handler method.
WARNING: If the handler method defines an @EventName only events matching one of the names and implementing NamedAcrossEvent will be handled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ParameterizedAcrossEvent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is done on the class of the event as well as on the defined generic parameters.
All instances matching the specific event class and the specific generic class (or subclasses) will be handled.
To support complex generic type filtering, implementations must specify their generic parameters as Spring ResolvableType instances.
Multiple generic parameters as well as nested generics are supported.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Filters can be combined: it is possible to filter an event on both event name and generic parameter.
An event must pass all filters before it is handled.</p>
</div>
<div class="listingblock">
<div class="title">Examples of custom events</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">/<strong>
 * Named events.
 */
class MyNamedEvent implements NamedAcrossEvent {
  @Override
  public String getEventName() {
    return "MyNamedEvent";
  }
}

@Event
public void handle( @EventName({"MyNamedEvent","MyOtherNamedEvent"}) NamedAcrossEvent event ) {
    // do something
}

/</strong>
 * Event with generic parameters.
 */
class MyListEvent&lt;T&gt; implements ParameterizedAcrossEvent {
  private final ResolvableType[] genericTypes;


  public MyListEvent( Class memberClass ) {
    genericTypes = new ResolvableType[] {
      ResolvableType.forClassWithGenerics( List.class, memberClass )
    };
  }


  @Override
  public ResolvableType[] getEventGenericTypes() {
    return genericTypes;
  }
}

@Event
public void handle( MyListEvent&lt;List&lt;Integer&gt;&gt; event ) {
  // would match against: new MyListEvent&lt;List&lt;Integer&gt;&gt;( Integer.class );
}</code></pre>
</div>
</div>
<h3 id="_advanced_event_filtering_and_asynchronous_event_handling" class="discrete">Advanced event filtering and asynchronous event handling</h3>
<div class="paragraph">
<p>Because the default implementation uses the MBassador messaging bus, it is possible to create custom filters and configure handlers or listeners to work asynchronously.
Please refer to the MBassador documentation on how to do this.</p>
</div>
<h3 id="_bootstrap_events" class="discrete">Bootstrap events</h3>
<div class="paragraph">
<p>The following bootstrap events are being published by the AcrossContext:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">AcrossModuleBeforeBootstrapEvent</dt>
<dd>
<p>Sent for each module, right before the bootstrapping of that module starts.
This is the very last point in time in which the ModuleBootstrapConfig can still be modified.</p>
</dd>
<dt class="hdlist1">AcrossModuleBootstrappedEvent</dt>
<dd>
<p>Sent for each module, right after the module has bootstrapped.</p>
</dd>
<dt class="hdlist1">AcrossContextBootstrappedEvent</dt>
<dd>
<p>Sent once for every AcrossContext, after the entire bootstrap phase has finished.</p>
</dd>
</dl>
</div>
<h3 id="_exceptions_in_events" class="discrete">Exceptions in events</h3>
<div class="paragraph">
<p>When dispatching an event through its handlers, each handler is executed in isolation from the others.
Events do not bubble up to the publisher.
This means if an exception occurs within a handler, that will not impact the original publisher in anyway and the next handler will simply execute.
However, when an exception occurs that is not handled within the handler method, a new PublicationError message is publishes that can be picked up with a custom IPublicationErrorHandler implementation added to the underlying MBassadorEventPublisher using addErrorHandler().
By default all exceptions will be logged in the AcrossEventPublisher logger.
There is no defined order in which an event is sent to the handlers.
Your event handlers should not depend on other event handlers having run.
WARNING: Ordering event handlers is currently not supported, issue #21 on the backlog hopes to resolve this in a future release.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_todo_refreshable_beans"><a class="anchor" href="#_todo_refreshable_beans"></a>11. TODO: Refreshable beans</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Refreshable and PostRefresh annotations TODO
postrefresh is always called</p>
</div>
<div class="sect2">
<h3 id="_refreshableregistry"><a class="anchor" href="#_refreshableregistry"></a>11.1. RefreshableRegistry</h3>
<div class="paragraph">
<p>A RefreshableRegistry is a collection of beans of a specified class that updates itself on every context refresh.  A RefreshableRegistry can also scan for beans inside the other modules in the running context, without the need for those beans to be exposed.  This allows other modules to pick up extensions or configurations from other modules that bootstrap later, and update its configuration on the context bootstrapped event.
The members of a RefreshableRegistry are also ordered according to the Across module order hierarchy (see section Ordering beans).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ordering-beans"><a class="anchor" href="#ordering-beans"></a>12. Ordering beans</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In an Across based application, the primary order of bean interaction should be defined by the module dependencies.
When scanning for beans in all modules (eg. when using a <code>RefreshableRegistry</code> or <code>@RefreshableCollection</code>), the beans will be returned according to the module order: beans from earlier bootstrapped modules will be before beans from later modules.
The reasoning is simple: <em>if I depend on module A, i can rely on module A having done its things before I will</em>.
If you need more sophisticated ordering, there are two extension points to the default behavior:</p>
</div>
<div class="paragraph">
<div class="title">Order annotation and Ordered interface</div>
<p>Core Spring classes.
If you define these on beans, these will take precedence over the order of the modules themselves.
The <code>Ordered</code> interface takes precedence over an <code>@Order</code> annotation, if both are present.
Using global ordering should be avoided as much as possible, but using for example <code>Ordered.LOWEST_PRECEDENCE</code> you can ensure that a bean comes after all other context created beans in the list.</p>
</div>
<div class="paragraph">
<div class="title">OrderInModule annotation and OrderedInModule interface</div>
<p>The equivalent of <code>@Order</code> and <code>Ordered</code>, but they only apply within a single module.
Use these if you have multiple beans (eg security configurers) of the same type in a single module, and it is important they follow a sequence.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Unless a specific order is given either through the interface or annotation, a default order of <code>Ordered.LOWEST_PRECEDENCE - 1000</code> is applied.
This way you can still force beans to be ordered behind beans without an explicit order.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The current version of Across does not apply the module order hierarchy to event handlers.
If event handlers need an order, it should be defined explicitly and you cannot rely that event handlers from other modules you depend on will have been executed before you.
This is an important work in progress for one of the next versions of Across.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="development-mode"><a class="anchor" href="#development-mode"></a>13. Development mode</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The AcrossContext can have development mode enabled through the <strong>developmentMode</strong> property.
Modules can use development mode to configure different services (or services differently).
An example is auto-reloading and no caching of the message sources if development mode is active.</p>
</div>
<div class="paragraph">
<p>Apart from setting the <strong>developmentMode</strong> property on <code>AcrossContext</code>, development mode can be activated the following way:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>property <strong>across.development.active</strong> is <em>true</em></p>
</li>
<li>
<p>Spring profile <strong>dev</strong> is active</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Resource resolving</div>
<p>By default resources (eg. messages, templates) are resolved from the classpath.
It is possible to configure a physical location for the resources of a module if development mode is active (eg on your local filesystem).
This is done in a special properties file that will be looked for in <strong>${user.home}/dev-configs/across-devel.properties</strong>.
The properties file should contain properties where the key references the module name, and the value the physical resources directory.</p>
</div>
<div class="listingblock">
<div class="title">Example development properties</div>
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">acrossModule.MyModule.resources=c:/code/mymodule/src/main/resources
acrossModule.OtherModule.resources=c:/code/othermodule/src/main/resources</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_todo_default_beans"><a class="anchor" href="#_todo_default_beans"></a>14. TODO: Default beans</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_acrosscontextinfo"><a class="anchor" href="#_acrosscontextinfo"></a>14.1. AcrossContextInfo</h3>

</div>
<div class="sect2">
<h3 id="_acrosscontextbeanregistry"><a class="anchor" href="#_acrosscontextbeanregistry"></a>14.2. AcrossContextBeanRegistry</h3>

</div>
<div class="sect2">
<h3 id="_acrossinstallerrepository"><a class="anchor" href="#_acrossinstallerrepository"></a>14.3. AcrossInstallerRepository</h3>

</div>
<div class="sect2">
<h3 id="_conversionservice"><a class="anchor" href="#_conversionservice"></a>14.4. ConversionService</h3>
<div class="paragraph">
<p>An AcrossContext requires a valid <code>ConversionService</code> bean named <strong>conversionService</strong> to be present.
If there is none, a <code>DefaultFormattingConversionService</code> will be created and exposed.
If you want to manage the <code>ConversionService</code> yourself, simply create a <code>ConversionService</code> with the right name in the parent <code>ApplicationContext</code>.</p>
</div>
<div class="paragraph">
<p>The default <strong>conversionService</strong> will also be attached to the <code>ApplicationContext</code> environment of every module.
This means property fetching using <code>Environment.getProperty()</code> methods will perform type conversion using the <code>ConversionService</code> (eg. useful for date property parsing).</p>
</div>
<div class="paragraph">
<div class="title">Date conversion</div>
<p>Apart from the <code>ConversionService</code> itself, an <code>AcrossContext</code> creates a default <code>StringToDateConverter</code> bean named <strong>defaultDateConverter</strong>.
This converter supports converting a string to a corresponding date in many common date patterns.
The <code>StringToDateConverter</code> assumes a fixed locale that can be configured (default: <code>US</code>).</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you manage the <code>ConversionService</code> outside of the <code>AcrossContext</code> the default <code>StringToDateConverter</code> will not be registered either.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_distributedlockrepository"><a class="anchor" href="#_distributedlockrepository"></a>14.5. DistributedLockRepository</h3>
<div class="paragraph">
<p>tbd</p>
</div>
</div>
<div class="sect2">
<h3 id="_acrossdevelopmentmode"><a class="anchor" href="#_acrossdevelopmentmode"></a>14.6. AcrossDevelopmentMode</h3>
<div class="paragraph">
<p>Utility bean that can be used to verify if <a href="#development-mode">development mode</a> is active, and to get development locations for resources files.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_developing_modules"><a class="anchor" href="#_developing_modules"></a>15. Developing modules</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="creating-an-acrossmodule"><a class="anchor" href="#creating-an-acrossmodule"></a>15.1. Creating an AcrossModule</h3>
<div class="paragraph">
<p>Creating a new Across module is done by extending <code>AcrossModule</code> and providing a valid name and description.
An <code>AcrossModule</code> is in essence a configuration class.
It uniquely identifies the module and holds all configuration parameters required to bootstrap the module.
It also allows you to alter settings of how beans should be shared with other modules.</p>
</div>
<div class="paragraph">
<p>A module name should be unique and as a best practice also be available as a public static final <strong>NAME</strong> field on the <code>AcrossModule</code> implementation.</p>
</div>
<div class="listingblock">
<div class="title">Minimal AcrossModule</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class ValidModule extends AcrossModule
{
	public static final String NAME = "ValidModule";

	@Override
	public String getName() {
		return NAME;
	}

	@Override
	public String getDescription() {
		return "ValidModule exposes some valid beans.";
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Making an AcrossModule autoconfigurable</div>
<p>For an Across module to be autoconfigurable it must adhere to the following conventions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the module name must be available in the public static final <strong>NAME</strong> field</p>
</li>
<li>
<p>the module must have public constructor without any parameters</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Definining beans</div>
<p>Upon bootstrap a module will create its own <code>ApplicationContext</code> with the <code>AcrossContext</code> as parent.
The beans created in the module <code>ApplicationContext</code> are configured using <code>ApplicationContextConfigurer</code> instances.</p>
</div>
<div class="paragraph">
<p>By default a scan for <code>@Configuration</code> classes will happen on the <strong>config</strong> package below the package of the <code>AcrossModule</code> implementation.
If you want more explicit control, you can override the <code>registerDefaultApplicationContextConfigurers()</code> method.</p>
</div>
<div class="paragraph">
<div class="title">Module resources</div>
<p>Most modules will also define one or more resources in a location determined on the <em>resources key</em> of the module.
By default the resources key or a module is the same as the module name.
You can change this by overriding the <code>getResourcesKey()</code> method.</p>
</div>
</div>
<div class="sect2">
<h3 id="_todo_module_settings"><a class="anchor" href="#_todo_module_settings"></a>15.2. TODO: Module settings</h3>
<div class="paragraph">
<p>about @ConfigurationProperties
Spring configuration metadata
property source</p>
</div>
</div>
<div class="sect2">
<h3 id="_module_dependencies_2"><a class="anchor" href="#_module_dependencies_2"></a>15.3. Module dependencies</h3>
<div class="paragraph">
<p>There are several ways to influence the beans that are being bootstrapped with a module, by passing information from the configuration to the actual module ApplicationContext.</p>
</div>
<div class="sect3">
<h4 id="__acrossdepends"><a class="anchor" href="#__acrossdepends"></a>15.3.1. @AcrossDepends</h4>
<h5 id="_using_acrossdepends_on_a_module" class="discrete">Using @AcrossDepends on a module</h5>
<div class="paragraph">
<p>Using AcrossDepends annotation on a component class you can avoid beans or Configurations from being created based on the presence of other modules.
required modules: the component will only be created if all required modules are present
optional modules: the component will only be created if at least one of the optional modules is present</p>
</div>
<h5 id="_using_acrossdepends_on_component_classes" class="discrete">Using @AcrossDepends on component classes</h5>
<div class="paragraph">
<p>expression will be evaluated against the module context - as usual - beans from earlier modules will be available</p>
</div>
</div>
<div class="sect3">
<h4 id="_todo_acrosscondition"><a class="anchor" href="#_todo_acrosscondition"></a>15.3.2. TODO: AcrossCondition</h4>
<div class="paragraph">
<p>AcrossCondition is another implementation of Spring Conditional.
AcrossCondition takes one or more Spring Expression Language (SpEL) statements as value, and all statements must evaluate to true before the component will be created.
It can be used to check environment or module properties (or any property on already existing beans from the parent context).
The current module instance can always be referenced under the key currentModule in the expression.</p>
</div>
<div class="listingblock">
<div class="title">Examples using AcrossCondition</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@AcrossCondition("#{currentModule.transactionEnabled}")
public class EnableTransactionConfiguration {
    // Only executed if the property isTransactionEnabled() on the AcrossModule instance is true
}

@Controller
@AcrossCondition("${mymodule.testcontroller:true}")
public class MyTestController {
    // The controller would only be created based on the property 'mymodule.testcontroller' in the Environment of the bootstrapping module
    // If the Environment does not contain the property, value 'true' will be used
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_todo_module_roles"><a class="anchor" href="#_todo_module_roles"></a>15.3.3. TODO: Module roles</h4>
<div class="paragraph">
<p>infrastructure modules</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bootstrap_interaction"><a class="anchor" href="#_bootstrap_interaction"></a>15.4. Bootstrap interaction</h3>
<div class="sect3">
<h4 id="moduleconfiguration"><a class="anchor" href="#moduleconfiguration"></a>15.4.1. @ModuleConfiguration</h4>
<div class="paragraph">
<p>Any module can provide a number of classes annotated with <code>@ModuleConfiguration</code>.
These classes are just like classes annotated with <code>@Configuration</code>, except they will not be added to the <code>ApplicationContext</code> of the current module, but to the ones of the modules specified in the annotation attributes.</p>
</div>
<div class="paragraph">
<p><code>@ModuleConfiguration</code> serves as a replacement for <code>@Configuration</code>.
All other bean related annotations like conditionals should also work on <code>@ModuleConfiguration</code> classes.
Keep in mind however that the actual creation of the beans (and evaluation of conditionals) will happen in the <code>ApplicationContext</code> to which the configuration is added, and not necessarily the one of the module defining the class.</p>
</div>
<div class="listingblock">
<div class="title">Example of using @ModuleConfiguration</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ModuleConfiguration(SpringSecurityModule.NAME)
public class SecurityConfiguration
{
	@Autowired
	public void configureGlobal( AuthenticationManagerBuilder auth ) throws Exception {
		auth.inMemoryAuthentication()
		    .withUser( "admin" ).password( "admin" )
		    .authorities( new NamedGrantedAuthority( "access administration" ) );
	}
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
When not specifying any module on a <code>@ModuleConfiguration</code>, the configuration will be added to all modules, including the module defining the class.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Scanning for <code>@ModuleConfiguration</code> classes</div>
<p>By default the sub-packages <strong>config</strong> and <strong>extensions</strong> of an <code>AcrossModule</code> will be scanned to detect classes annotated with <code>@ModuleConfiguration</code>.
A module can configure these packages by overriding the <code>getModuleConfigurationScanPackages()</code> method.</p>
</div>
</div>
<div class="sect3">
<h4 id="_todo_subscribe_to_events"><a class="anchor" href="#_todo_subscribe_to_events"></a>15.4.2. TODO: Subscribe to events</h4>

</div>
<div class="sect3">
<h4 id="_todo_prepareforbootstrap"><a class="anchor" href="#_todo_prepareforbootstrap"></a>15.4.3. TODO: prepareForBootstrap</h4>
<div class="paragraph">
<p>A third approach for customizing module configuration is implementing prepareForBootstrap() on the AcrossModule.
This is the last point in time were any module can modify the bootstrap configuration of any other module (adding configurers, modifying expose filter etc).</p>
</div>
<div class="paragraph">
<p>todo: ModuleConfigurationSet</p>
</div>
<div class="listingblock">
<div class="title">Example of a prepareForBootstrap</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Override
public void prepareForBootstrap( ModuleBootstrapConfig currentModule, AcrossBootstrapConfig contextConfig ) {
    if ( ArrayUtils.contains( supportedViews, AcrossWebViewSupport.JSP ) ) {
        currentModule.addApplicationContextConfigurer(
                new AnnotatedClassConfigurer( JstlViewSupportConfiguration.class ) );
    }
    if ( ArrayUtils.contains( supportedViews, AcrossWebViewSupport.THYMELEAF ) ) {
        currentModule.addApplicationContextConfigurer(
                new AnnotatedClassConfigurer( ThymeleafViewSupportConfiguration.class ) );
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exposing_beans_2"><a class="anchor" href="#_exposing_beans_2"></a>15.5. Exposing beans</h3>
<div class="paragraph">
<p>A module can share its beans with other modules by <strong>exposing</strong> them.
All exposed beans from a module are pushed upwards into the parent <code>ApplicationContext</code> of the <code>AcrossContext</code> itself.
Likewise, at the end of the context bootstrap, all exposed beans are pushed into the <code>ApplicationContext</code> that is - optionally - configured as the parent of the <code>AcrossContext</code>.</p>
</div>
<div class="paragraph">
<p>Which beans are exposed is determined by the <code>exposeFilter</code> property on an <code>AcrossModule</code>.
By default all beans annotated with <code>@Exposed</code> or <code>@Service</code> will be exposed.
See the <code>com.foreach.across.core.filters.BeanFilter</code> implementations for standard filters.</p>
</div>
<div class="paragraph">
<p>When pushing beans to the parent <code>ApplicationContext</code> it is possible to run into name conflicts or duplicate bean types.
You can use an <code>ExposedBeanDefinitionTransformer</code> to modify the bean definitions that are pushed to the parent.
Common examples for this are changing the bean names or marking the beans as primary.
You can set the transformer to use through the <code>exposeTransformer</code> property on an <code>AcrossModule</code> or the <code>AcrossContext</code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">ExposedBeanDefinitionTransformer on AcrossModule</dt>
<dd>
<p>will be applied when pushing beans from the module into the <code>AcrossContext</code></p>
</dd>
<dt class="hdlist1">ExposedBeanDefinitionTransformer on AcrossModule</dt>
<dd>
<p>will be applied when pushing beans from the <code>AcrossContext</code> into the parent <code>ApplicationContext</code></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class SomeModule extends AcrossModule
{
	/**
	 * Only expose specific beans from this module and ensure that
	 * they have a prefixed bean name for the other modules.
	 */
	public SomeModule() {
		setExposeFilter( new ClassBeanFilter( PlatformTransactionManager.class, SessionFactory.class ) );
		setExposeTransformer( new BeanPrefixingTransformer( "someModule" ) );
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Beans created directly in the <code>AcrossContext</code> scope - and not inside one of the modules - will only be exposed if they are annotated explicitly with <code>@Exposed</code>.
The <code>AcrossContext</code> does not support a custom <code>exposeFilter</code> but you can supply an additional <code>exposeTransformer</code> on the context level.
If you want to avoid an <code>AcrossContext</code> to push the exposed beans further upwards into its parent <code>ApplicationContext</code>, you should configure the <code>ExposedBeanDefinitionTransformer.REMOVE_ALL</code> as <code>exposeTransformer</code> on the <code>AcrossContext</code> itself.
For an <code>AcrossModule</code> using the <code>REMOVE_ALL</code> transformer would be the same as putting <code>null</code> as <code>exposeFilter</code>.</p>
</div>
<div class="paragraph">
<div class="title">Manually exposing beans</div>
<p>In addition to setting the <em>exposeFilter</em> property, <code>AcrossModule</code> has <code>expose(&#8230;&#8203;)</code> methods that allow you to quickly expose one or more beans based on bean name or type.</p>
</div>
</div>
<div class="sect2">
<h3 id="_message_sources"><a class="anchor" href="#_message_sources"></a>15.6. Message sources</h3>
<div class="sect3">
<h4 id="auto-detecting-message-sources"><a class="anchor" href="#auto-detecting-message-sources"></a>15.6.1. Auto-detecting message sources</h4>
<div class="paragraph">
<p>If a module has a message source packaged in the right location it will be auto-detected and configured.
The following default message properties will be configured automatically if they are present on the classpath:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>/messages/MODULE_RESOURCES/MODULE_NAME.properties <em>(deprecated)</em></p>
</li>
<li>
<p>/messages/MODULE_RESOURCES/default.properties</p>
</li>
<li>
<p>/messages/MODULE_RESOURCES/default/*.properties</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The default message sources are configured using an instance of <code>AcrossModuleMessageSource</code>.
<code>AcrossModuleMessageSource</code> is a special case of Spring&#8217;s <code>ReloadableResourceBundleMessageSource</code>.
If development mode is active and the development locations for the module have been configured, the classpath lookups are replaced by physical file lookups with a cache time of 1 second.
This is very useful during development where updates to resource bundles can be instantly visible.</p>
</div>
<div class="paragraph">
<p>Automatic configuration of message sources only happens if the module does not define a bean named <strong>messageSource</strong>.
The following section details how you can manually define message sources.</p>
</div>
</div>
<div class="sect3">
<h4 id="_message_source_hierarchy"><a class="anchor" href="#_message_source_hierarchy"></a>15.6.2. Message source hierarchy</h4>
<div class="paragraph">
<p>Across has its own custom behavior in relation to <strong>messageSource</strong> beans declared in modules.
Each module can declare a default <code>MessageSource</code> bean named <strong>messageSource</strong>.
Upon bootstrap this message source will be added to a hierarchy along with all other <strong>messageSource</strong> beans.
Once bootstrap is complete, a message will be looked up in all sources defined.</p>
</div>
<div class="paragraph">
<div class="title">Default message source hierarchy</div>
<p>By default Across uses the following approach to build a message source hierarchy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <strong>messageSource</strong> bean from a parent <code>ApplicationContext</code> is considered to be application specific and should allow
customizing the messages of the modules</p>
</li>
<li>
<p>a <strong>messageSource</strong> bean in a module is expected to be able to customize messages from other modules that the current
module depends on</p>
<div class="ulist">
<ul>
<li>
<p>this is also interpreted as: the message source of a module takes precedence over the message source of earlier modules</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a result, once a context is fully bootstrapped and a message is requested, the sources are queried in the following order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>message sources of the parent <code>ApplicationContext</code> (and up its hierarchy if more than one parent)</p>
</li>
<li>
<p>message sources of the modules in reverse bootstrap order (last bootstrapped first)</p>
</li>
</ol>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Once an <code>AcrossContext</code> is fully bootstrapped, messages will be looked up in the hierarchy built from all bootstrapped modules.
During the bootstrap phase however, only message sources from earlier modules and the parent <code>ApplicationContext</code> are available.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Reverting to default spring behavior</div>
<p>Default Spring behavior with message sources is that a <code>MessageSource</code> in an <code>ApplicationContext</code> will get the <code>MessageSource</code> of the parent <code>ApplicationContext</code> as its parent.
In a module setup, this would mean that a message would first be looked up in the source of the module, and only afterwards in the source of the context.
You can force the default behavior to apply by annotating a <strong>messageSource</strong> bean with <code>@Internal</code>.
Note that in that case the <strong>messageSource</strong> will remain internal to the module where it&#8217;s declared.</p>
</div>
<div class="listingblock">
<div class="title">Configuring a custom message source for a module with development mode support</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
public class ModuleConfig
{
	@Bean
	public MessageSource messageSource() {
        AcrossModuleMessageSource source = new AcrossModuleMessageSource();
        source.setBasenames( "classpath:/my/module/messages );

        return source;
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installers_2"><a class="anchor" href="#_installers_2"></a>15.7. Installers</h3>
<div class="paragraph">
<p>A module can have one or more installer classes.
The purpose of installers is setup data that modules need, before the actual application takes over.
Examples: creating database schema, installing default or test data&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>An <code>@Installer</code> annotation marks a class as an installer and allows you to specify the important installer attributes.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">attribute</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional (unique) name of the installer.
If not specified, the fully qualified class name of the installer class will be used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Descriptive text of what will be installed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>phase</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When this installer should run during the context bootstrap.
See <a href="#installer-bootstrap-phases">bootstrap phases</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>runCondition</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Condition when this installer should run.  See <a href="#installer-run-conditions">run conditions</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>version</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version number of the installer.
This value should be incremented to enforce a new run of the same installer.
Only relevant if the run condition is <code>VersionDifferent</code>.</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_installer_detection"><a class="anchor" href="#_installer_detection"></a>15.7.1. Installer detection</h4>
<div class="paragraph">
<p>By default installers are detected from the classpath by scanning the <strong>installers</strong> package relative to the package of the <code>AcrossModule</code>.
Changing the packages to scan for installers can be done by overriding the <code>getInstallerScanPackages()</code> method on <code>AcrossModule</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you manually want to specify a list of installers, you can do so by overriding the <code>getInstallers()</code> method.
Though still possible for compatibility reasons, installers should be specified with their <code>Class</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_installer_tracking_and_synchronization"><a class="anchor" href="#_installer_tracking_and_synchronization"></a>15.7.2. Installer tracking and synchronization</h4>
<div class="paragraph">
<p>The execution of installers is tracked using the <code>AcrossInstallerRepository</code>.
This allows for installers to execute only if they have not yet been executed (see <a href="#installer-run-conditions">run conditions</a>).</p>
</div>
<div class="paragraph">
<p>In addition, installer execution is synchronized for multiple applications connecting on the same database.
This is done through the <code>DistributedLockRepository</code> that is created in the core schema.
A lock will be taken on the datasource as soon as a single installer wishes to execute, and will only be released once bootstrapping is fully done.</p>
</div>
<div class="paragraph">
<p>Because of tracking and synchronization, a <a href="#installer-datasource">datasource</a> is required in order to execute installers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>AcrossInstallerRepository</code> can be wired as a bean in installers.
This can be helpful in migration trajectories for example to rename installers.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="installer-bootstrap-phases"><a class="anchor" href="#installer-bootstrap-phases"></a>15.7.3. Bootstrap phases</h4>
<div class="paragraph">
<p>Installers are executed during a specific phase of the context bootstrap.
This phase should be specified for every installer.
The phase will determine which beans are available in the installer.</p>
</div>
<div class="paragraph">
<p>The following bootstrap phases exist:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">BeforeContextBootstrap</dt>
<dd>
<p>The installer is executed before any of the modules in the AcrossContext are bootstrapped.
Only beans from the parent <code>ApplicationContext</code> or the <a href="#installer-applicationcontext">installer <code>ApplicationContext</code></a> are available.</p>
</dd>
<dt class="hdlist1">BeforeModuleBootstrap</dt>
<dd>
<p>The installer is executed before the module that owns it bootstraps, but after all previous modules have bootstrapped.
All beans from previous modules will also be available to the installer.</p>
</dd>
<dt class="hdlist1">AfterModuleBootstrap</dt>
<dd>
<p>The installer is executed after the module that owns it has bootstrapped, but before the next module bootstraps.
All beans from the current module are available.</p>
</dd>
<dt class="hdlist1">AfterContextBootstrap</dt>
<dd>
<p>The installer is executed after all modules have bootstrapped, but before the <code>AcrossContextBootstrappedEvent</code> is published.
All beans from all modules are available.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="installer-run-conditions"><a class="anchor" href="#installer-run-conditions"></a>15.7.4. Run conditions</h4>
<div class="paragraph">
<p>The following run conditions are supported for an installer:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">AlwaysRun</dt>
<dd>
<p>The installer will always be executed, everytime the module bootstraps.</p>
</dd>
<dt class="hdlist1">VersionDifferent</dt>
<dd>
<p>The installer will only execute if the <em>version</em> attribute is higher than the version previously executed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>In addition to the standard run conditions, you can use <a href="#installer-conditionals"><code>@Conditional</code> annotations on installer classes</a>.
This includes for example the use of <code>@AcrossDepends</code> to execute installers if certain modules are active.</p>
</div>
</div>
<div class="sect3">
<h4 id="_installer_group"><a class="anchor" href="#_installer_group"></a>15.7.5. Installer group</h4>
<div class="paragraph">
<p>In addition to the standard <code>@Installer</code> attributes, an <code>@InstallerGroup</code> annotation can be specified.
This allows grouping types of installers together (for example schema) and overruling their execution using <a href="#installer-settings"><code>InstallerSettings</code></a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_installer_execution_order"><a class="anchor" href="#_installer_execution_order"></a>15.7.6. Installer execution order</h4>
<div class="paragraph">
<p>If all conditions are fulfilled, installers will be executed in a predetermined order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>in <a href="#installer-bootstrap-phases">bootstrap phase</a> order</p>
</li>
<li>
<p>in <a href="#across-bootstrap-order">module bootstrap order</a></p>
</li>
<li>
<p>in installer order (according to <code>@Order</code> annotations on the installer class)</p>
</li>
</ol>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Installers without an <code>@Order</code> annotation behave as if they have an order index of <strong>0</strong>.
In that case the installer registration order will be used as a fallback, with installers specified through <code>getInstallers()</code> having a higher precedence.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="installer-datasource"><a class="anchor" href="#installer-datasource"></a>15.7.7. Datasources and installers</h4>
<div class="paragraph">
<p>An <code>AcrossContext</code> requires at least one datasource if modules need to run installers.
Certain core features like the <code>DistributedLockRepository</code> also require the core schema to be installed and will require a valid datasource to be configured.</p>
</div>
<div class="paragraph">
<p>The main datasource is available for all modules as a bean named <code>acrossDataSource</code>.
Optionally a separate installer datasource can be configured that will be available as <code>acrossInstallerDataSource</code>.
If no separate installer datasource is specified, the default across datasource will be used.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
A valid default datasource is always required for installers to run.
It is not possible to configure only an installer datasource as the distributed locking mechanism uses the default datasource.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The installer datasource is the default datasource used for all <code>AcrossLiquibaseInstaller</code> instances.</p>
</div>
</div>
<div class="sect3">
<h4 id="installer-applicationcontext"><a class="anchor" href="#installer-applicationcontext"></a>15.7.8. Installer ApplicationContext</h4>
<div class="paragraph">
<p>If installers need to be run for a module, a specific <code>ApplicationContext</code> is created in which the installers will be wired as beans.
This <code>ApplicationContext</code> can exist before the actual module <code>ApplicationContext</code> does.
However, all beans from the parent Across context and the module context - when created - are available in installers.</p>
</div>
<div class="paragraph">
<p>Installer contexts are temporary, once the Across context has bootstrapped they are closed.
Configuration and other annotated classes can be added to the installer context by using <code>ApplicationContextConfigurer</code> implementations, either on the <code>AcrossContext</code> or on an <code>AcrossModule</code>.</p>
</div>
<div class="paragraph">
<p>By default, the package <strong>installers.config</strong> relative to the module package will be scanned for beans to be added to the installer <code>ApplicationContext</code>.</p>
</div>
<div class="listingblock">
<div class="title">Example using different datasource inside the modules</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
class Config implements AcrossContextConfigurer
{
    /**
     * Installer tracking will be done on this datasource.
     */
    @Bean
    public EmbeddedDatabase acrossDataSource() {
        return new EmbeddedDatabaseBuilder()
                .setType( EmbeddedDatabaseType.HSQL )
                .setName( "core" )
                .build();
    }

    @Bean
    public EmbeddedDatabase moduleDataSource() {
        return new EmbeddedDatabaseBuilder()
                .setType( EmbeddedDatabaseType.HSQL )
                .setName( "data" )
                .build();
    }

    @Override
    public void configure( AcrossContext context ) {
        ProvidedBeansMap beans = new ProvidedBeansMap();
        beans.put( AcrossContext.DATASOURCE, new PrimarySingletonBean( moduleDataSource() ) );
        beans.put( AcrossContext.INSTALLER_DATASOURCE, moduleDataSource() );

        context.addApplicationContextConfigurer( new ProvidedBeansConfigurer( beans ),
                                                 ConfigurerScope.MODULES_ONLY );
        context.addInstallerContextConfigurer( new ProvidedBeansConfigurer( beans ) );
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The installer context has no web support as it is a direct implementation of <code>AcrossApplicationContext</code> but does not implement <code>WebApplicationContext</code>.
</td>
</tr>
</table>
</div>
<div id="installer-conditionals" class="paragraph">
<p>Installers are registered as bean definitions in the installer <code>ApplicationContext</code>.
You can use any Spring <code>@Conditional</code> annotations to suppress installer execution, even if the run conditions are fulfilled.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When registering bean definitions to the installer context, a good practice is to demarcate beans as <code>@Lazy</code>.
 In that case they will never get created if the installer conditionals fail.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_acrossliquibaseinstaller"><a class="anchor" href="#_acrossliquibaseinstaller"></a>15.7.9. AcrossLiquibaseInstaller</h4>
<div class="paragraph">
<p>Across core comes with an <code>AcrossLiquibaseInstaller</code> class.
This is an abstract base class for executing liquibase XML resources.
Simply extending the base class and annotating as installer will execute an XML resource in the same package as the installer class against the installer datasource.</p>
</div>
<div class="listingblock">
<div class="title">Example using different datasource inside the modules</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package my.package;

@Installer(description = "Liquibase installer", runCondition = InstallerRunCondition.AlwaysRun)
public class LiquibaseInstaller extends AcrossLiquibaseInstaller
{
    // Will execute the resource file 'my/package/LiquibaseInstaller.xml'
    // As liquibase has its own locking mechanism (slower than Across!), we can safely always run
}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_schemaconfiguration"><a class="anchor" href="#_schemaconfiguration"></a>SchemaConfiguration</h5>
<div class="paragraph">
<p>An <code>AcrossLiquibaseInstaller</code> will use a <code>SchemaConfiguration</code> bean to configure its default schema and pass configuration properties.
A <code>SchemaConfiguration</code> for the current module will be looked up first, if none is found a default bean will be used if it exists.</p>
</div>
<div class="paragraph">
<p>The default <code>SchemaConfiguration</code> is a bean without any <code>@Module</code> annotations.
The presence of a <code>@Module</code> annotation marks that <code>SchemaConfiguration</code> as applying only for that particular module.</p>
</div>
<div class="paragraph">
<p>If no default or module <code>SchemaConfiguration</code> is found, the installer will continue without setting a default schema.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Adding <code>SchemaConfiguration</code> beans to a context directly via a <code>ProvidedBeansConfigurer</code> erases the visibility of bean declaration annotations.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example of a configuration class defining some <code>SchemaConfiguration</code> beans</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package my.package;

@EnableAcrossContext
@Configuration
public class SchemaConfig
{
    /<strong>
     * AcrossLiquibaseInstaller in the QuotationModule will automatically pick up this SchemaConfiguration.
     * Liquibase scripts will run with 'MY_QUOTATIONS' as their default schema.
     */
     @Bean
     @Module( "QuotationModule" )
     public SchemaConfiguration userSchemaConfiguration() {
        return new SchemaConfiguration( "MY_QUOTATIONS" );
     }

     /</strong>
      * This is the default SchemaConfiguration.
      * AcrossLiquibaseInstaller in other module will pick up this SchemaConfiguration.
      */
     @Bean
     public SchemaConfiguration defaultSchemaConfiguration() {
        return new SchemaConfiguration( "MY_SCHEMA" );
     }
}</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Fixing a default schema</div>
<p>Alternatively the <code>SchemaConfiguration</code> bean schema can be ignored and a default schema fixed on the <code>AcrossLiquibaseInstaller</code>.
This is done in the installer implementation through the <code>setDefaultSchema()</code> method.</p>
</div>
<div class="listingblock">
<div class="title">Example fixed schema configuration using <code>AcrossLiquibaseInstaller#setDefaultSchema</code></div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package my.package;

/**
 * Liquibase script of this installer will run with 'IM_SPECIAL' as default schema.
 * Regardless of any defined SchemaConfiguration.
 */
@Installer(description = "Liquibase installer", runCondition = InstallerRunCondition.AlwaysRun)
public class SpecialSchemaInstaller extends AcrossLiquibaseInstaller
{
    public SpecialSchemaInstaller() {
        setDefaultSchema( "IM_SPECIAL" );
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="installer-settings"><a class="anchor" href="#installer-settings"></a>15.7.10. InstallerSettings</h4>
<div class="paragraph">
<p>For advanced configuration, both <code>AcrossContext</code> and <code>AcrossModule</code> allow <code>InstallerSettings</code> to be set.
<code>InstallerSettings</code> can be used to set the action (eg. force executed, skip) to be performed for one or more installers or installer groups.</p>
</div>
<div class="paragraph">
<p><code>InstallerSettings</code> accepts an <code>InstallerActionResolver</code> for determining install action at runtime.
Alternatively an installer can implement <code>InstallerActionResolver</code> that will be used in a second stage only if the original action is <code>EXECUTE</code>.</p>
</div>
<div class="paragraph">
<p>Please refer to the javadoc for more information.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_module_version_information"><a class="anchor" href="#_module_version_information"></a>15.8. Module version information</h3>
<div class="paragraph">
<p>Across modules have version information attached in the form of an <code>AcrossVersionInfo</code> property.
This object provides information like the current version and time when it was built.
By default this information is fetched automatically from the <strong>META-INF/MANIFEST.MF</strong> resource.
The following attributes are required for a fully configured <code>AcrossVersionInfo</code> instance:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. MANIFEST attributes</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Example</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Implementation-Title</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">across-web</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the project the class (<code>AcrossModule</code>) belongs to. Often also the JAR name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Implementation-Version</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.2.RELEASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build version of the <code>AcrossModule</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Build-Time</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20150831-1011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timestamp when the version was built (in <strong>yyyyMMdd-HHmm</strong> format).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Using Maven a valid MANIFEST file can automatically be created using the following plugin configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
    &lt;version&gt;2.6&lt;/version&gt;
    &lt;configuration&gt;
        &lt;archive&gt;
            &lt;manifest&gt;
                &lt;addDefaultImplementationEntries&gt;true&lt;/addDefaultImplementationEntries&gt;
            &lt;/manifest&gt;
            &lt;manifestEntries&gt;
                &lt;Build-Time&gt;${maven.build.timestamp}&lt;/Build-Time&gt;
            &lt;/manifestEntries&gt;
        &lt;/archive&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<h1 id="across-web" class="sect0"><a class="anchor" href="#across-web"></a>III. Across Web</h1>
<div class="sect1">
<h2 id="_general_information"><a class="anchor" href="#_general_information"></a>16. General information</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_todo_about"><a class="anchor" href="#_todo_about"></a>16.1. TODO: About</h3>
<div class="paragraph">
<p>AcrossWebModule provides the following infrastructure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a thymeleaf across dialect</p>
</li>
<li>
<p>a menu builder</p>
</li>
<li>
<p>auto configuration of <a href="#multipart-config">Multipart filter</a></p>
</li>
<li>
<p>auto configuration of static resources with <a href="#client-side-caching">client-side caching</a> and <a href="#resource-url-versioning">url versioning</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Module website: <a href="https://foreach.atlassian.net/wiki/display/AX/Across+web+module" class="bare">https://foreach.atlassian.net/wiki/display/AX/Across+web+module</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_artifact_2"><a class="anchor" href="#_artifact_2"></a>16.2. Artifact</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.foreach.across&lt;/groupId&gt;
        &lt;artifactId&gt;across-web&lt;/artifactId&gt;
        &lt;version&gt;1.1.2.RELEASE&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="across-web-module-settings"><a class="anchor" href="#across-web-module-settings"></a>16.3. Module settings</h3>
<div class="paragraph">
<p>All properties start with the <strong>acrossWebModule.</strong> prefix.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">views.thymeleaf.enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Should Thymeleaf view support be enabled.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>true</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">views.jsp.enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Should JSP/JSTL view support be enabled.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>false</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resources.path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relative path for serving all static resources.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/across/resources</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resources.folders</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default subfolders of <em>views</em> that should be served as static resources.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">js,css,static</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resources.versioning.enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Auto configure versioning of the default resource resolvers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>true</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resources.versioning.version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fixed version if resource versioning is enabled.  Default will use build number or module version.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>null</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resources.caching.enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Auto configure client-side caching of static resources.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>true</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resources.caching.period</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Period for client-side resource caching (if enabled).  Defaults to 1 year.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>60*60*24*365</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templates.enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Should support for <a href="#web-templates">web templates</a> be enabled.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>true</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templates.auto-register</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <a href="#web-templates">web templates</a> are enabled, should named templates be autodetected.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>true</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">multipart.auto-configure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Should a multipart resolver be configured automatically.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>true</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">multipart.settings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MultipartConfigElement</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multipart upload settings, if missing defaults will be used.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>null</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">development-views</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Map&lt;String,String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map of physical locations for views resources.  Only used if development mode is active.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Collections.emptyMap()</em></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_todo_web_mvc_coniguration"><a class="anchor" href="#_todo_web_mvc_coniguration"></a>17. TODO: Web MVC coniguration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Extending modules should just define a WebMvcConfigurer component or configuration (does not need to be exposed).
To avoid the default configuration: extend AcrossWebModule and override default context configurers.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_todo_prefixed_handler_mapping"><a class="anchor" href="#_todo_prefixed_handler_mapping"></a>18. TODO: Prefixed handler mapping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>prefixed handler mapping</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_acrosswebmodule_and_conversionservice"><a class="anchor" href="#_acrosswebmodule_and_conversionservice"></a>19. AcrossWebModule and ConversionService</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AcrossWebModule requires a <code>FormattingConversionService</code> bean named <strong>mvcConversionService</strong> to be present.
If there is none, one will be created and exposed.  By default the parent <strong>conversionService</strong> bean will be reused if
it implements the right interface.  If you want to manage the <strong>mvcConversionService</strong> separately, simply create
 a <code>FormattingConversionService</code> with the right name in the parent context.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
public class ManualConversionServiceConfiguration
{
	@Bean(name = AcrossWebModule.CONVERSION_SERVICE_BEAN)
	public FormattingConversionService mvcConversionService() {
	    return new FormattingConversionService();
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>mvcConversionService</strong> will be passed to all <code>WebMvcConfigurer</code> instances in order to add formatters.  It is also
the default <code>ConversionService</code> attached to the <code>WebDataBinder</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There will be at least 2 <code>ConversionService</code> beans in the across context when <code>AcrossWebModule</code> is enabled:
<strong>conversionService</strong> and <strong>mvcConversionService</strong>.  If you have duplicate bean exceptions due to unqualified autowiring,
you should make one of both primary.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="across-application"><a class="anchor" href="#across-application"></a>20. TODO: @AcrossApplication</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>@AcrossApplication</code> annotation can be used as an alternative for <code>@EnableAcrossContext</code> when defining an application.
In addition to default context configuration options, it adds Spring Boot auto configuration classes for embedded servlet containers and enables dynamic modules.</p>
</div>
<div class="sect2">
<h3 id="_embedded_servlet_container"><a class="anchor" href="#_embedded_servlet_container"></a>20.1. Embedded servlet container</h3>
<div class="paragraph">
<p>Using <code>@AcrossApplication</code> adds the necessary Spring Boot auto configuration classes for embedded servlet containers.
If you have for example <strong>spring-boot-starter-tomcat</strong> on the classpath, you can run an Across based application inside an embedded Tomcat using <code>SpringApplication</code>.</p>
</div>
<div class="listingblock">
<div class="title">Minimal example of a Spring Boot based Across application</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@AcrossApplication(modules = { MyModule.NAME, MyOtherModule.NAME })
public class MyApplication
{
	public static void main( String[] args ) {
		SpringApplication.run( MyApplication.class, args );
	}
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dynamic_across_modules"><a class="anchor" href="#_dynamic_across_modules"></a>20.2. Dynamic Across modules</h3>
<div class="paragraph">
<p>Using <code>@AcrossApplication</code> on a class will automatically enable dynamic Across modules on that class.
Before bootstrapping the context, the configurator will attempt to find an application specific infrastructure, application or postprocessor module.
The name of the expected module is generated based on the name of the importing class.
If no module with that name can be resolved, the configurator will see if a child package is present relative to the package of the importing class.
Depending on the child package name, a dynamic module will be generated.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Importing class</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MyApplication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MyConfiguration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Infrastructure module</strong><br>
package: <em>infrastructure</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MyApplicationInfrastructureModule<br>
resources: myApplicationInfrastructure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MyConfigurationInfrastructureModule<br>
resources: myConfigurationInfrastructure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Application module</strong><br>
package: <em>application</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MyApplicationModule<br>
resources: <strong>my</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MyConfigurationApplicationModule<br>
resources: <strong>myConfiguration</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>PostProcessor module</strong><br>
package: <em>postprocessor</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MyApplicationPostProcessorModule<br>
resources: myApplicationPostProcessor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MyConfigurationPostProcessorModule<br>
resources: myConfigurationPostProcessor</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example package structure for application modules</div>
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">com.mypackage
  MyApplication.class
  application.config
    MyApplicationModuleConfiguration.class
  infrastructure.installers
    SchemaInstallerToRunBeforeAnyOtherModule.class</code></pre>
</div>
</div>
<div class="paragraph">
<p>Disabling dynamic modules on an <code>@AcrossApplication</code> can be done through the <strong>enableDynamicModules</strong> attribute.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Dynamic modules perform an automatic component scan of all their child packages with the exception of <em>installers</em> and <em>extensions</em>.
If you want the default behavior of scanning only the <em>config</em> child package, you must provide an <code>AcrossModule</code> implementation.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you want to manually add dynamic modules, please see the javadoc for <code>AcrossDynamicModulesConfigurer</code> and <code>AcrossDynamicModulesConfiguration</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>TODO: old school web initializer for bootstrapping with support for dynamic servlets and filters</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="multipart-config"><a class="anchor" href="#multipart-config"></a>21. Multipart support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default AcrossWebModule will attempt to automatically configure a <code>MultipartFilter</code> to support multipart form data.
When correctly configured, this will enable multipart support for all servlets and web requests.</p>
</div>
<div class="paragraph">
<div class="title">Servlet container support</div>
<p>By default a <code>StandardServletMultipartFilter</code> is being added, that builds on top of the Servlet 3.0 specification.
Servlets will still need a <code>MultipartConfigElement</code> set for multipart data to be handled correctly.
The latter is done automatically for the <code>DispatcherServlet</code>.</p>
</div>
<div class="paragraph">
<div class="title">Customizing the multipart configuration</div>
<p>Common settings (eg. max file size) can be customized by providing a <code>MultipartConfigElement</code> bean.
This bean will be automatically picked up for the configuration.
If none is present, AcrossWebModule will create a default bean.</p>
</div>
<div class="paragraph">
<div class="title">Apache Commons support</div>
<p>If <a href="#commons-fileupload-url">Apache Commons FileUpload</a> is available on the classpath, the filter will be configured using a <code>CommonsMultipartResolver</code> instead.</p>
</div>
<div class="paragraph">
<div class="title">Manually creating a MultipartResolver</div>
<p>It is also possible to manually create a <code>MultipartResolver</code> bean.
The bean name will determine how multipart resolving is applied:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>filterMultipartResolver</strong></dt>
<dd>
<p>Will still enable the <code>MultipartFilter</code> to be registered but will use the configured bean as its internal resolver.</p>
</dd>
<dt class="hdlist1"><strong>multipartResolver</strong></dt>
<dd>
<p>Will disable the <code>MultipartFilter</code> registration, but will register the resolver on the <code>DispatcherServlet</code>.
Multipart support will only be enabled on requests made through the <code>DispatcherServlet</code>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Spring Boot will automatically rename any <code>MultipartResolver</code> bean to <strong>multipartResolver</strong> so it will be picked up by the <code>DispatcherServlet</code>.
If you want to use the <code>MultipartFilter</code> but want to customize the <code>MultipartResolver</code> it uses, you should ensure that the resolver bean is injected in the AcrossWebModule and not exposed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Disabling multipart configuration</div>
<p>Disabling the automatic multipart resolving configuration can be done by setting <strong>acrossWebModule.multipart.auto-configure</strong> to <code>false</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_static_resources"><a class="anchor" href="#_static_resources"></a>22. Static resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AcrossWebModule automatically enables serving of static resources bundled with modules.
With the default settings static resources will be configured with <a href="#resource-url-versionng">versioned urls</a> and <a href="#client-side-caching">client-side caching</a>.</p>
</div>
<div class="sect2">
<h3 id="_conventions"><a class="anchor" href="#_conventions"></a>22.1. Conventions</h3>
<div class="paragraph">
<p>The default resources are served from the <strong>/views</strong> folder on the classpath.
By default AcrossWebModule will serve resources from:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>/views/js</p>
</li>
<li>
<p>/views/css</p>
</li>
<li>
<p>/views/static</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additional subfolders can be configured with the <strong>acrossWebModule.resources.folders</strong> property.</p>
</div>
<div class="paragraph">
<p>By convention (and for best development mode support) module specific resources should be located in a subfolder with the <code>resourcesKey</code> of the module.</p>
</div>
<div class="listingblock">
<div class="title">Example resources layout for MyModule</div>
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">src/main/resources
   views/
     static/
       MyModule/
         js/controller.js
         css/my-module.css
         img/logo.png
     th/
       MyModule/
         controller.thtml
         user-profile.thtml</code></pre>
</div>
</div>
<div class="paragraph">
<p>The relative path under which the static resources are available is determined by the <strong>acrossWebModule.resources.path</strong> property.</p>
</div>
</div>
<div class="sect2">
<h3 id="client-side-caching"><a class="anchor" href="#client-side-caching"></a>22.2. Client-side caching</h3>
<div class="paragraph">
<p>By default static resources will be cached on the client-side for a period of 1 year.
Disabling client-side caching is done with the <strong>acrossWebModule.resources.caching.enabled</strong> property.
If client-side caching is disabled, no cache headers will be sent to the client.</p>
</div>
<div class="paragraph">
<p>Configuring the caching period is done separately with the <strong>acrossWebModule.resources.caching.period</strong> property.
Setting the value to <strong>0</strong> with caching enabled will sent <strong>no-cache</strong> headers.
This is also the default if development mode is active.</p>
</div>
</div>
<div class="sect2">
<h3 id="resource-url-versioning"><a class="anchor" href="#resource-url-versioning"></a>22.3. Resource URL versioning</h3>
<div class="paragraph">
<p>By default AcrossWebModule enables <a href="http://docs.spring.io/spring-framework/docs/current/spring-framework-reference/html/mvc.html#mvc-config-static-resources">Spring versioning of static resources</a>.
This will generate versioned URLs, create a <code>ResourceUrlProvider</code> bean and add a <code>ResourceUrlEncodingFilter</code> and <code>ResourceUrlProviderExposingInterceptor</code> to the request handlers.</p>
</div>
<div class="paragraph">
<p>Using versioned resource URLs is transparent:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in Thymeleaf all relative links added with <code>@{/relative/path}</code> will be rewritten if necessary</p>
</li>
<li>
<p>in JSP the equivalent is the <code>&lt;spring:url value="/relative/path" var="url"/&gt;</code> tag</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using these will work both with or without resource versioning.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If versioning is disabled, the <code>ResourceUrlProvider</code> will not be available on the request.
Modules using accessing the <code>ResourceUrlProvider</code> directly should built-in support for this.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_fixed_version_strategy"><a class="anchor" href="#_fixed_version_strategy"></a>22.3.1. Fixed version strategy</h4>
<div class="paragraph">
<p>AcrossWebModule supports automatic configuration of resource versioning using a single fixed version.
When enabled this means that resources of the form <strong>/across/resources/static/mymodule/mymodule.css</strong> will get rewritten to <strong>/across/resources/static/VERSION/mymodule/mymodule.css</strong>.</p>
</div>
<div class="paragraph">
<p>The fixed version used is determined as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>acrossWebModule.resources.versioning.version</strong> property</p>
</li>
<li>
<p><strong>build.number</strong> property</p>
</li>
<li>
<p>version of the AcrossWebModule</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Using the fixed version strategy works well for relative includes in both CSS and JS files, avoiding the need to rewrite URLs inside those files.</p>
</div>
</div>
<div class="sect3">
<h4 id="_customizing_the_version_strategy"><a class="anchor" href="#_customizing_the_version_strategy"></a>22.3.2. Customizing the version strategy</h4>
<div class="paragraph">
<p>It is possible to keep configuration of the default resources active but only change the version strategy used.
This can be done by injecting your own <code>VersionResourceResolver</code> bean named <strong>versionResourceResolver</strong> the AcrossWebModule context.</p>
</div>
<div class="listingblock">
<div class="title">Example providing custom version strategy</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ModuleConfiguration(AcrossWebModule.NAME)
public static class CustomVersionResourceResolver
{
	@Bean
	public VersionResourceResolver versionResourceResolver() {
		return new VersionResourceResolver()
				.addVersionStrategy( new FixedVersionStrategy( "1.0" ), "/**/*.css" )
				.addVersionStrategy( new FixedVersionStrategy( "2.0" ), "/**" );
	}
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Because of limitations of the <code>CssLinkTransformer</code> in combination with a fixed version strategy, AcrossWebModule does not rewrite links inside css files.
If you absolutely need this in your application, you will have to disable the automatic resource versioning and configure it yourself.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_webresourceregistry"><a class="anchor" href="#_webresourceregistry"></a>22.4. WebResourceRegistry</h3>
<div class="paragraph">
<p>AcrossWebModule allows for programatically registering web resources through the use of a <code>WebResourceRegistry</code>.
A new <code>WebResourceRegistry</code> is attached to every request and can be accessed as a request attribute or a handler method parameter.</p>
</div>
<div class="paragraph">
<p>Resources can be added in a group (eg: css, javascript) and with a specific location (eg: relative, views, external).
The groups can be used for retrieval of related resources, the location determines the <code>WebResourceTranslator</code> that will be used.
Web resource translating happens before the actual view is rendered and allows for the data to be converted into a more appropriate format for the view rendering.
Using the <code>WebResource.VIEWS</code> location for a web resource will have the relative path prefixed with the configured across web views resources prefix.</p>
</div>
<div class="paragraph">
<p>Resources can be identified with a unique key, ensuring they are added only once.</p>
</div>
<div class="listingblock">
<div class="title">Example controller registering specific web resources</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Controller
public class MyController
{
	@ModelAttribute
	public void registerWebResources( WebResourceRegistry webResourceRegistry ) {
	    webResourceRegistry.add( WebResource.CSS, "//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css, WebResource.EXTERNAL );
	    webResourceRegistry.add( WebResource.CSS, "/static/mymodule/css/main.css", WebResource.VIEWS );
	}
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Views can access the <code>WebResourceRegistry</code> under the <strong>webResourceRegistry</strong> attribute.
It is however the view implementation that will determine how resources are handled.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_webresourcepackage"><a class="anchor" href="#_webresourcepackage"></a>22.4.1. WebResourcePackage</h4>
<div class="paragraph">
<p>To avoid adding single items, web resources can be bundled into a <code>WebResourcePackage</code> and registered with the <code>WebResourcePackageManager</code>.
Adding an entire package can then be done by calling <code>WebResourceRegistry#addPackage</code> with the right package name.</p>
</div>
<div class="listingblock">
<div class="title">Example creating a WebResourcePackage</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Component
public class BootstrapUiWebResources extends SimpleWebResourcePackage
{
	public static final String VERSION = "3.3.5";
	public static final String NAME = "bootstrap";

	public BootstrapUiWebResources() {
		setDependencies( JQueryWebResources.NAME );     // Install the jquery package first
		setWebResources(
				new WebResource( WebResource.CSS, NAME,
				                 "//maxcdn.bootstrapcdn.com/bootstrap/" + VERSION + "/css/bootstrap.min.css",
				                 WebResource.EXTERNAL ),
				new WebResource( WebResource.JAVASCRIPT_PAGE_END, NAME,
				                 "//maxcdn.bootstrapcdn.com/bootstrap/" + VERSION + "/js/bootstrap.min.js",
				                 WebResource.EXTERNAL )
		);
	}

	@Autowired
	public void registerPackage( WebResourcePackageManager packageManager ) {
	    packageManager.register( NAME, this );
	}
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_development_mode_support"><a class="anchor" href="#_development_mode_support"></a>23. Development mode support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AcrossWebModule supports development mode retrieval of physical resources.
If the conventions for static resources and Thymeleaf templates were followed, these will be fetched automatically from their physical location.
This ensures that an application restart is not required for static resources or Thymeleaf rendering.</p>
</div>
<div class="paragraph">
<p>If development mode is active AcrossWebModule will also send no-cache headers for static resources and will use a generated fixed version if versioning is enabled.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_todo_jsp_and_thymeleaf_integration"><a class="anchor" href="#_todo_jsp_and_thymeleaf_integration"></a>24. TODO: JSP and Thymeleaf integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If both JSP and Thymeleaf support are enabled, you can easily use both view types at the same time.  The <code>AcrossWebModule</code>
 also provides a tag that can be used to import Thymeleaf templates or fragments in a JSP rendering pipeline.  The same
 model (request attributes) should be available in the Thymeleaf template as in the calling JSP.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;%@ taglib prefix="across" uri="http://across.foreach.com/tags" %&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"&gt;
&lt;head&gt;
	&lt;title&gt;JSP including a Thymeleaf template&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;across:thymeleaf template="th/mymodule/thymeleaf-from-jsp-include" /&gt;
	&lt;div class="child"&gt;
		&lt;across:thymeleaf template="th/mymodule/thymeleaf-from-jsp-include :: fragment" /&gt;
	&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>mention serving of thymeleaf files</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_development_mode_support_2"><a class="anchor" href="#_development_mode_support_2"></a>25. Development mode support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AcrossWebModule supports development mode retrieval of physical resources.
If the conventions for static resources and Thymeleaf templates were followed, these will be fetched automatically from their physical location.
This ensures that an application restart is not required for static resources or Thymeleaf rendering.</p>
</div>
<div class="paragraph">
<p>If development mode is active AcrossWebModule will also send no-cache headers for static resources and will use a generated fixed version if versioning is enabled.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="web-templates"><a class="anchor" href="#web-templates"></a>26. Web templates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AcrossWebModule provides support for simple template processing.
A controller method can be linked to a specific template which will determine some pre- and post-processing that might be done.
The base infrastructure is provided by <code>WebTemplateProcessor</code>, <code>WebTemplateInterceptor</code> and <code>WebTemplateRegistry</code>.</p>
</div>
<div class="sect2">
<h3 id="_creating_a_template"><a class="anchor" href="#_creating_a_template"></a>26.1. Creating a template</h3>
<div class="paragraph">
<p>The easiest way to create a new template is to create a bean extending <code>LayoutTemplateProcessorAdapterBean</code>.
Your implementation should get a unique name and a path to the template view file.
This basic template implementation has adapter methods for registering of web resources and generating one or more menu structures.</p>
</div>
<div class="listingblock">
<div class="title">Example layout template implementation</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Component
public class MyTemplate extends LayoutTemplateProcessorAdapterBean {

    public MyTemplate() {
        super( "MyTemplate", "th/mysite/layout" );
    }

    @Override
    protected void registerWebResources( WebResourceRegistry registry ) {
        registry.add( WebResource.CSS, "/static/mysite/css/main.css", WebResource.VIEWS );
    }

    @Override
    protected void buildMenus( MenuFactory menuFactory ) {
        menuFactory.buildMenu( "topMenu" );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the template is applied it will take the original view name and put it as a model attribute with the key <strong>childPage</strong>.
The actual template view can then dispatch to the original view (or parts of it) when building the final layout.</p>
</div>
<div class="listingblock">
<div class="title">Example Thymeleaf template that renders the content fragment of the original view</div>
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head&gt;
    &lt;title&gt;My Site&lt;/title&gt;

    &lt;script th:each="javascript : ${webResourceRegistry.getResources('javascript')}" th:src="@{${javascript.data}}"
            th:if="${javascript.location != 'inline'}"&gt;&lt;/script&gt;

    &lt;link rel="stylesheet" type="text/css" th:each="css : ${webResourceRegistry.getResources('css')}"
          th:href="@{${css.data}}"/&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div th:replace="${childPage} :: content"&gt;
        Insert original view
    &lt;/div&gt;

    &lt;script th:each="javascript : ${webResourceRegistry.getResources('javascript-page-end')}" th:src="@{${javascript.data}}"
            th:if="${javascript.location != 'inline'}"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_linking_a_template_to_a_controller"><a class="anchor" href="#_linking_a_template_to_a_controller"></a>26.2. Linking a template to a controller</h3>
<div class="paragraph">
<p>Any controller method can specify the template to use by setting the <code>@Template</code> annotation with the unique template name.
The <code>@Template</code> annotation can be set on the <code>@Controller</code> itself (in which case it will apply to all mapping methods) or on mapping method directly.
The latter will always take precedence.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can always clear a template from being applied by setting a <code>@ClearTemplate</code> annotation on a method.
Special Spring MVC return options (like methods annotated with <code>@ResponseBody</code>) will automatically suppress the template.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_registering_the_default_template"><a class="anchor" href="#_registering_the_default_template"></a>26.3. Registering the default template</h3>
<div class="paragraph">
<p>If no explicit template is specified, the default template will be used it there is one.
The default template must be set on the <code>WebTemplateRegistry</code>.
 set on the <code>WebTemplateRegistry</code>.</p>
</div>
<div class="listingblock">
<div class="title">Example template registering itself as default</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Component
public class MyTemplate extends LayoutTemplateProcessorAdapterBean {
    ...

    @Autowired
    public void registerAsDefaultTemplate( WebTemplateRegistry webTemplateRegistry ) {
        webTemplateRegistry.setDefaultTemplateName( getName() );
    }

    ...
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_building_menus"><a class="anchor" href="#_building_menus"></a>27. Building menus</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AcrossWebModule provides some infrastructure to build a tree-like menu.
The output class is a <code>Menu</code> instance that is created by the <code>MenuFactory</code> service.
When building a menu, a <code>BuildMenuEvent</code> is published with the menu instance, the name of the menu will be the name of the event.
The <code>BuildMenuEvent</code> provides access to a <code>PathBasedMenuBuilder</code> that allows asynchronous registering of menu items with a unique hierarchical path.
After the event handling the actual menu will be built and path structure will be used for the tree hierarchy.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dynamic-servlet-registration"><a class="anchor" href="#dynamic-servlet-registration"></a>28. Registering servlets and filters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is possible to register <code>Servlet</code> and <code>Filter</code> instances from within an Across module.
This can be easily done by implementing an <code>AcrossWebDynamicServletConfigurer</code> bean that will give you access to a configurable <code>ServletContext</code>.
During bootstrap, AcrossWebModule will detect all <code>AcrossWebDynamicServletConfigurer</code> beans and execute them <a href="#ordering-beans">in order</a>.</p>
</div>
<div class="listingblock">
<div class="title">Example registering the resourceUrlrEncodingFilterConfiguration after all other filters</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Order(Ordered.LOWEST_PRECEDENCE)
@Configuration("resourceUrlEncodingFilterConfiguration")
@ConditionalOnProperty(value = "acrossWebModule.resources.versioning.enabled", matchIfMissing = true)
public static class ResourceUrlEncodingFilterConfiguration extends AcrossWebDynamicServletConfigurer
{
	public static final String FILTER_NAME = "ResourceUrlEncodingFilter";

	private static final Logger LOG = LoggerFactory.getLogger( ResourceUrlEncodingFilterConfiguration.class );

	@Override
	protected void dynamicConfigurationAllowed( ServletContext servletContext ) throws ServletException {
		FilterRegistration.Dynamic resourceUrlEncodingFilter
			= servletContext.addFilter( FILTER_NAME, new ResourceUrlEncodingFilter() );
		resourceUrlEncodingFilter.addMappingForUrlPatterns(
			EnumSet.of(
					DispatcherType.REQUEST,
					DispatcherType.ERROR,
					DispatcherType.ASYNC
			),
			true,
			"/*"
		);
	}

	@Override
	protected void dynamicConfigurationDenied( ServletContext servletContext ) throws ServletException {
		LOG.warn( "Unable to auto configure ResourceUrlEncodingFilter." );
	}
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
By default <code>AcrossWebDynamicServletConfigurer</code> requires a synchronous startup of the <code>ServletContext</code>.
However a fallback method will be called if the bootstrap is not synchronous (<code>dynamicConfigurationDenied()</code>).
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="default-http-encoding"><a class="anchor" href="#default-http-encoding"></a>29. Default HTTP encoding</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AcrossWebModule registers a default <code>CharacterEncodingFilter</code> that forces the request and response encoding to use UTF-8.
This is done through the <code>HttpEncodingAutoConfiguration</code> from Spring Boot and can be controlled with the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>spring.http.encoding.enabled</p>
</li>
<li>
<p>spring.http.encoding.charset</p>
</li>
<li>
<p>spring.http.encoding.force</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a <code>CharacterEncodingFilter</code> bean is found in the parent <code>ApplicationContext</code> but default HTTP encoding is enabled, AcrossWebModule will take care of registering that filter bean.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_todo_web_path_resolving"><a class="anchor" href="#_todo_web_path_resolving"></a>30. TODO: Web path resolving</h2>
<div class="sectionbody">
<div class="paragraph">
<p>link builders:
prefixing path context
special characters:
- ! = suppress prefix
- {adminWeb}/boe/test/</p>
</div>
</div>
</div>
<h1 id="across-test" class="sect0"><a class="anchor" href="#across-test"></a>IV. Across Test</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Across Test is a utility library that provides helpers for integration testing of Across modules in both a standard and web context.
Across Test builds on top of the Spring testing library.</p>
</div>
<h2 id="_artifact_3" class="discrete">Artifact</h2>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.foreach.across&lt;/groupId&gt;
        &lt;artifactId&gt;across-test&lt;/artifactId&gt;
        &lt;version&gt;1.1.2.RELEASE&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_base_test_classes"><a class="anchor" href="#_base_test_classes"></a>31. Base test classes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_module_conventions_test"><a class="anchor" href="#_module_conventions_test"></a>31.1. Module conventions test</h3>
<div class="paragraph">
<p>Across Test comes with a base unit test class that can be used to verify an <code>AcrossModule</code> implementation adheres to the <a href="#module-conventions">conventions</a>.
All you have to do is extend from <code>AbstractAcrossModuleConventionsTest</code> and implement the <code>createModule()</code> method.</p>
</div>
<div class="listingblock">
<div class="title">Basic implementation of a module conventions test</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class TestAcrossWebModuleConventions extends AbstractAcrossModuleConventionsTest
{
	@Override
	protected AcrossModule createModule() {
		return new AcrossWebModule();
	}
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="test-builders"><a class="anchor" href="#test-builders"></a>32. Test context builders</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Across Test comes with a set of helpers for integration testing an Across module with all its dependencies.
Main access point is the <code>AcrossTestBuilders</code> class that will provide you with either an <code>AcrossTestContextBuilder</code> or <code>AcrossTestWebContextBuilder</code>.
The latter should be used if you want to simulate a web container environment.</p>
</div>
<div class="paragraph">
<p>Both builder implementations provide a fluent api for easily configuring an <code>AcrossContext</code> and setting application properties.
See the javadoc for all different configuration options.
Upon building the <code>AcrossContext</code> will be bootstrapped and an instance of <code>AcrossTestContext</code> will be returned.
<code>AcrossTestContext</code> (and the extending <code>AcrossTestWebContext</code>) wraps around the bootstrapped <code>AcrossContext</code> and provides easy querying of the bootstrapped context.
In addition <code>AcrossTestContext</code> implements <code>Closeable</code> that shuts down the context, easy for using with try-with-resources.</p>
</div>
<div class="listingblock">
<div class="title">Simple text context builder example</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
public void verifySomeBeanIsExposed() {
    try (
            AcrossTestContext ctx = AcrossTestBuilders.standard()
                    .modules( SomeModule.NAME )
                    .build()
    ) {
        // SomeBean should be available in the root context
        assertNotNull( ctx.getBeanOfType( SomeBean.class ) );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the builders will by default load the <a href="#test-datasources">test datasources</a> and will execute a reset of the databases before bootstrapping.
Both options can be configured separately on the builder.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
You should obviously make sure you are not dropping the databases when connecting to an existing database.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example connecting to existing datasource</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
public void doSomethingOnExisting() {
    try (
            AcrossTestContext ignore = AcrossTestBuilders.standard()
                    .useTestDataSource( false )
                    .dropFirst( false )
                    .dataSource( ds )
                    .build()
    ) {
        ...
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In a web scenario the <code>AcrossTestWebContextBuilder</code> should be used.
This will ensure a <code><a href="#mock-across-servlet-context">MockAcrossServletContext</a></code> is being used and return an <code>AcrossTestWebContext</code>.
The <code>AcrossTestWebContext</code> provides access to the <code>MockAcrossServletContext</code> and a <code>MockMvc</code> bean that is instantiated with all filters registered by the modules.</p>
</div>
<div class="listingblock">
<div class="title">Example web context builder with mock mvc call</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
public void filterNotRegisteredButResourceStillWorks() {
    try (
            AcrossTestWebContext ctx = AcrossTestBuilders.web()
                    .property( "acrossWebModule.resources.versioning.enabled", "false" )
                    .modules( AcrossWebModule.NAME )
                    .build()
    ) {
        // URL encoding filter should not be registered
        MockAcrossServletContext servletContext = ctx.getServletContext();
        assertNull( servletContext.getFilterRegistration( ResourceUrlEncodingFilterConfiguration.FILTER_NAME ) );

        // Static resource should still be returned
        MockMvc mvc = ctx.mockMvc();
        mvc.perform( get( "/across/resources/static/testResources/test.txt" ) )
            .andExpect( status().isOk() )
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="test-annotations"><a class="anchor" href="#test-annotations"></a>33. Annotations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Across Test library also provides a set of Across-specific annotations that extend the default Spring Testing annotations (eg <code>@ContextConfiguration</code>) to support <code>AcrossContext</code> setups.</p>
</div>
<div class="sect2">
<h3 id="annotation-across-test-configuration"><a class="anchor" href="#annotation-across-test-configuration"></a>33.1. @AcrossTestConfiguration</h3>
<div class="paragraph">
<p>Class-level annotation to be used as an alternative to <code><a href="#enableacrosscontext">@EnableAcrossContext</a></code>.
Like <code>@EnableAcrossContext</code> this annotation will configure and bootstrap an <code>AcrossContext</code> but also add support for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#test-datasources">test datasources</a></p>
</li>
<li>
<p>resetting the database before bootstrap</p>
</li>
<li>
<p>creating a <code>MockMvc</code> bean instantiated with all dynamically registered filters from the context, when used in a <code><a href="#acrosswebappconfiguration">@AcrossWebAppConfiguration</a></code> test class</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When using either <code>@EnableAcrossContext</code> or <code>@AcrossTestConfiguration</code>, all beans exposed can be wired directly in the unit test class.</p>
</div>
<div class="listingblock">
<div class="title">Example using @AcrossTestConfiguration</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RunWith(SpringJUnit4ClassRunner.class)
@DirtiesContext
@ContextConfiguration
public class TestSample
{
	@Autowired
	private MyExposedBean myExposedBean;

	@Test
	public void doSomethingWithMyExposedBean() {
		...
	}

	@AcrossTestConfiguration(modules = { MyModule.NAME })
	protected static class Config
	{
	}
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="acrosswebappconfiguration"><a class="anchor" href="#acrosswebappconfiguration"></a>33.2. @AcrossWebAppConfiguration</h3>
<div class="paragraph">
<p>Class-level annotation that sets up a <code>@WebAppConfiguration</code> test that uses a <code><a href="#mock-across-servlet-context">MockAcrossServletContext</a></code> for initialization.
<code>@AcrossWebAppConfiguration</code> contains a <code>@ContextConfiguration</code> annotation, unless additional annotations are specified, it will load static innter <code>@Configuration</code> classes of the annotated test class.</p>
</div>
<div class="paragraph">
<p>When using this annotation on a test class the <code>MockAcrossServletContext</code> instance can be autowired for introspection.
In combination with an inner static <code>@AcrossTestConfiguration</code> class, this will support a <code>MockMvc</code> instance initialized with all dynamically registered filters.</p>
</div>
<div class="listingblock">
<div class="title">Example combining @AcrossWebAppConfiguration and @AcrossTestConfiguration</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RunWith(SpringJUnit4ClassRunner.class)
@DirtiesContext
@AcrossWebAppConfiguration
@TestPropertySource( properties = "acrossWebModule.resources.versioning.enabled=false" )
public class TestSample
{
    @Autowired
    private MockAcrossServletContext servletContext;

	@Autowired
	private MockMvc mvc;

	@Test
	public void resourceUrlEncodingFilterShouldNotBeRegistered() {
        assertNull( servletContext.getFilterRegistration( ResourceUrlEncodingFilterConfiguration.FILTER_NAME ) );
	}

	@Test
	public void staticResourceShouldBeReturned() {
	    mvc.perform( get( "/across/resources/static/testResources/test.txt" ) )
           .andExpect( status().isOk() )
	}

	@AcrossTestConfiguration(modules = { AcrossWebModule.NAME })
	protected static class Config
	{
	}
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_spring_boot_application_testing"><a class="anchor" href="#_spring_boot_application_testing"></a>34. Spring Boot Application testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is possible to test your <code>@AcrossApplication</code> with Spring Boot testing support.
Using the <code>@SpringApplicationConfiguration</code> in your tests is necessary for default <em>application.properties</em> loading and YAML support.
Refer to the Spring Boot reference documentation for more information on Spring Boot testing facilities.</p>
</div>
<div class="sect2">
<h3 id="__webintegrationtest"><a class="anchor" href="#__webintegrationtest"></a>34.1. @WebIntegrationTest</h3>
<div class="paragraph">
<p>A full-stack web integration test (eg. with an embedded Tomcat) does not require any special configuration.</p>
</div>
<div class="listingblock">
<div class="title">Example integration test with an embedded servlet container on a random port</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RunWith(SpringJUnit4ClassRunner.class)
@WebIntegrationTest(randomPort = true)
@SpringApplicationConfiguration(classes = MyApplication.class)
public class TestSpringBootWebIntegration
{
	private final TestRestTemplate restTemplate = new TestRestTemplate();

	@Value("${local.server.port}")
	private int port;

	@Test
	public void controllersShouldSayHello() {
		assertEquals( "application says hello", get( "/application" ) );
		assertEquals( "infrastructure says hello", get( "/infrastructure" ) );
	}

	private String get( String relativePath ) {
		return restTemplate.getForEntity( url( relativePath ), String.class ).getBody();
	}

	private String url( String relativePath ) {
		return "http://localhost:" + port + relativePath;
	}
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="boot-integration-test-mockmvc"><a class="anchor" href="#boot-integration-test-mockmvc"></a>34.2. Integration test with MockMvc support</h3>
<div class="paragraph">
<p>It is also possible to start your entire <code>@AcrossApplication</code> without an embedded servlet container.
However if you want to have support for <code>MockMvc</code> instantiated with dynamically registered filters, you must manually configure the application loader to use a <code><a href="#mock-across-servlet-context">MockAcrossServletContext</a></code>.
This is done by adding the required configuration and initializer classes to the <code>@SpringApplicationConfiguration</code>.
See the <a href="#appendix-test-configuration-classes">appendix section</a> for an overview of all configuration classes available.</p>
</div>
<div class="listingblock">
<div class="title">Example Spring Boot integration test with MockMvc</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@SpringApplicationConfiguration(
		classes = { MyApplication.class, MockMvcConfiguration.class },
		initializers = MockAcrossServletContextInitializer.class
)
public class TestSpringBootMockMvc
{
	@Autowired
	private MockMvc mockMvc;

	@Test
	public void controllersShouldSayHello() throws Exception {
		assertContent( "application says hello", get( "/application" ) );
		assertContent( "infrastructure says hello", get( "/infrastructure" ) );
	}

	private void assertContent( String expected, RequestBuilder requestBuilder ) throws Exception {
		mockMvc.perform( requestBuilder )
		       .andExpect( status().isOk() )
		       .andExpect( content().string( is( expected ) ) );
	}
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Using <code>@AcrossWebAppConfiguration</code> in combination with <code>@SpringApplicationConfiguration</code> is not possible, as the context loaders they use conflict with each other.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mock_mvc_integration"><a class="anchor" href="#_mock_mvc_integration"></a>35. Mock MVC integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default using either the <a href="#test-builders">test builders</a> or <a href="#annotation-across-test-configuration">@AcrossTestConfiguration</a> will provide you with a singleton <code>MockMvc</code> instance that is configured with the bootstrapped <code>AcrossContext</code>.
You can also manually add this singleton configuration by importing the <code>MockMvcConfiguration</code> in your test application context, see the example in the <a href="#boot-integration-test-mockmvc">Spring Boot section</a>.</p>
</div>
<div class="paragraph">
<p>Across Test also provides a <code>AcrossMockMvcBuilders</code> class that has factory methods for creating an ad hoc <code>MockMvcBuilder</code> based on a bootstrapped <code>AcrossContext</code>.
Use this implementation if you want to customize the <code>MockMvc</code> configuration, for example for Spring REST documentation generation.</p>
</div>
<div class="listingblock">
<div class="title">Ad hoc instantiation of a MockMvc instance</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RunWith(SpringJUnit4ClassRunner.class)
@DirtiesContext
@AcrossWebAppConfiguration
public class TestSample
{
    @Autowired
    private AcrossContextInfo contextInfo;

    private MockMvc mvc;

    @Before
    public void setUp() {
        this.mvc = AcrossMockMvcBuilders.acrossContextSetup( contextInfo ).build();
    }

    @Test
    public void staticResourceShouldBeReturned() {
        mvc.perform( get( "/across/resources/static/testResources/test.txt" ) )
           .andExpect( status().isOk() )
    }

    @EnableAcrossContext(modules = { AcrossWebModule.NAME })
    protected static class Config
    {
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_dynamic_modules"><a class="anchor" href="#_testing_dynamic_modules"></a>36. Testing dynamic modules</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Testing dynamic modules outside of a full <code>@AcrossApplication</code> test can be done by adding one or more <code>AcrossDynamicModulesConfigurer</code> instances to the <code>AcrossContext</code> configuration.
Every configurer instance is responsible for building a set of dynamic modules for a particular base package.
An existing <code>@AcrossApplication</code> class can easily be reused as base for the configurer.</p>
</div>
<div class="listingblock">
<div class="title">Example adding dynamic modules to a builder</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
public void dynamicModulesRegistration() {
    try (
            AcrossTestContext ctx = standard()
                    .configurer( new AcrossDynamicModulesConfigurer( DummyApplication.class ) )
                    .build()
    ) {
        assertTrue( ctx.contextInfo().hasModule( "DummyApplicationModule" ) );
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example adding dynamic modules to an annotations based test</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RunWith(SpringJUnit4ClassRunner.class)
@DirtiesContext
@ContextConfiguration
public class TestDynamicModulesConfiguration
{
	@Autowired
	private AcrossContextInfo contextInfo;

	@Test
	public void sampleModulesShouldBeAdded() {
	    assertTrue( contextInfo.hasModule( "DummyApplicationModule" ) );
   	}

	@Configuration
	@EnableAcrossContext
	protected static class SampleConfiguration
	{
		@Bean
		public AcrossDynamicModulesConfigurer sampleDynamicModules() {
			return new AcrossDynamicModulesConfigurer( DummyApplication.class );
		}
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mock-across-servlet-context"><a class="anchor" href="#mock-across-servlet-context"></a>37. MockAcrossServletContext</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>MockAcrossServletContext</code> is an extension of the <code>MockServletContext</code> from Spring Test.
It adds an implementation that keeps track of all registered servlets, filters and listeners.</p>
</div>
<div class="paragraph">
<p>Unlike the <code>MockServletContext</code> this implementation does not throw an <code>UnsupportedOperationException</code> on registration operations.
For common operations like servlet and filter registration this implementation will behave as an actual <code>ServletContext</code> from a web container.
The actual registrations that occurred can be retrieved - in order - from the <code>MockAcrossServletContext</code>.</p>
</div>
<div class="paragraph">
<p><code>MockAcrossServletContext</code> can also mimic initialization of the <code>ServletContext</code>.
When <code>initialize()</code> is called, the <code>init()</code> methods of the servlet/filter instances will be called with the registration parameters.
Note that <code>initialize()</code> can be called only once, and afterwards all registration operations will throw an <code>IllegalStateException</code>.</p>
</div>
<div class="paragraph">
<p>Using a <code>MockAcrossServletContext</code> can be used for unit testing <code>AcrossWebDynamicServletConfigurer</code> implementations or for integration tests needing web functionality.
<code>MockAcrossServletContext</code> is used automatically behind the scenes when using the <a href="#test-builders">test builders</a> or <a href="#test-annotations">annotations</a>.
In an integration test scenario, the implementation can either be wired as a bean (when using the <a href="#test-annotations">annotations</a>) or retrieved from the resulting <code>AcrossTestWebContext</code>.</p>
</div>
<div class="paragraph">
<p>Please refer to the javadoc for <code>MockAcrossServletContext</code> for more information.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="test-datasources"><a class="anchor" href="#test-datasources"></a>38. Test datasources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When using the Across Test <a href="#test-annotations">annotations</a> or <a href="#test-builders">builders</a>, default support for test datasources is activated.
If no specific datasource is configured on the <code>AcrossContext</code> a default test datasource will be detected.</p>
</div>
<div class="paragraph">
<div class="title">Test datasource detection</div>
<p>Test datasources can be configured in a specific property file, located at <strong>${user.home}/dev-configs/across-test.properties</strong>.
That file is automatically loaded and can contain multiple datasource sections, where every datasource has a unique <strong>NAME</strong> and its properties are prefixed with <strong>acrossTest.datasource.NAME</strong>.
Required properties for a valid datasource are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>acrossTest.datasource.NAME.driver</p>
</li>
<li>
<p>acrossTest.datasource.NAME.url</p>
</li>
<li>
<p>acrossTest.datasource.NAME.username</p>
</li>
<li>
<p>acrossTest.datasource.NAME.password</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example across-test.properties file</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">acrossTest.datasource.mysql.driver=com.mysql.jdbc.Driver
acrossTest.datasource.mysql.url=jdbc:mysql://127.0.0.1:3306/testdb
acrossTest.datasource.mysql.username=testdb_user
acrossTest.datasource.mysql.password=testdb_pwd</code></pre>
</div>
</div>
<div class="paragraph">
<p>When configuring the context, the environment property <strong>acrossTest.datasource</strong> will be checked to determine the <strong>NAME</strong> of the actual datasource that shoul be used.
If that property does not exist or holds the value <strong>auto</strong>, an embedded HSQLDB is automatically added instead.
This ensures that installers can always run against an actual datasource.</p>
</div>
<div class="paragraph">
<p>If you want to change the fallback default datasource, you can do so by setting the <strong>acossTest.datasource.default</strong> property value.</p>
</div>
<div class="paragraph">
<p>INFO: A common strategy is to run the integration tests multiple times with a different <strong>acrossTest.datasource</strong> property.
The <strong>standard-module-bom</strong> automatically configures your maven build to run all unit test starting with <strong>IT</strong>* in the integration-test phase.
This is an efficient way to test for example installer compatibility for different database types.</p>
</div>
<div class="paragraph">
<p>If you want to manually add support for test datasources, you should add a <code>TestDataSourceConfigurer</code> for configuring the <code>AcrossContext</code>.</p>
</div>
<div class="paragraph">
<div class="title">Database reset</div>
<p>When using test datasources it is usually wanted behaviour to drop the database content before bootstrapping the <code>AcrossContext</code>.
This is done automatically when you are using the Across Test annotations or builders.
If you want to add this manually, you should add a <code>ResetDatabaseConfigurer</code> to the context configuration.</p>
</div>
</div>
</div>
<h1 id="_v_appendices" class="sect0"><a class="anchor" href="#_v_appendices"></a>V. Appendices</h1>
<div class="sect1">
<h2 id="_advanced_topics"><a class="anchor" href="#_advanced_topics"></a>39. Advanced topics</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_module_resolving"><a class="anchor" href="#_module_resolving"></a>39.1. Module resolving</h3>
<div class="paragraph">
<p>By default modules are resolved using a <code>ClassPathScanningModuleDependencyResolver</code>.
If a module can&#8217;t be resolved the reason is usually one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the package containing the module has not been added for module scanning</p>
</li>
<li>
<p>there is no <code>public static final String NAME</code> field containing the unique module name</p>
</li>
<li>
<p>there is no public constructor without parameters</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can configure more verbose logging by setting the logger level for <code>com.foreach.across.core.context.ClassPathScanningCandidateModuleProvider</code> to <code>TRACE</code>.
This will output all candidate modules that have been considered during scanning.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conventions_2"><a class="anchor" href="#_conventions_2"></a>40. Conventions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="module-conventions"><a class="anchor" href="#module-conventions"></a>40.1. TODO: AcrossModule</h3>

</div>
<div class="sect2">
<h3 id="_todo_acrossapplication"><a class="anchor" href="#_todo_acrossapplication"></a>40.2. TODO: @AcrossApplication</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_todo_published_events"><a class="anchor" href="#_todo_published_events"></a>41. TODO: Published events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following is a listing of all events published by Across core or <code>AcrossWebModule</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix-test-configuration-classes"><a class="anchor" href="#appendix-test-configuration-classes"></a>42. Test configuration classes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Across Test library has a number of <code>@Configuration</code> and <code>AcrossContextConfigurer</code> classes that can come in useful when setting up integration tests.
These configurations can be found in the <code>com.foreach.across.test.support.config</code> package.</p>
</div>
<div class="paragraph">
<p>Making use of these directly is only required when setting up integration tests without the Across <a href="#test-annotations">test annotations</a> or <a href="#test-builders">builders</a>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Test configuration classes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"><code>TestDataSourceConfigurer</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AcrossContextConfigurer</code> that will configure the <a href="#test-datasources">test datasource</a> on the <code>AcrossContext</code> if no other datasource has been set.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ResetDatabaseConfigurer</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AcrossContextConfigurer</code> that resets the datasources attached to the <code>AcrossContext</code> before it bootstraps.
This will drop all tables, stored procedures etc in the database.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MockMvcConfiguration</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configures a <code>MockMvc</code> bean that will be created from a bootstrapped <code>AcrossContext</code>.
If a <code>MockAcrossServletContext</code> is available, all registered filters will be configured on the <code>MockMvc</code> instance.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MockAcrossServletContextInitializer</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2016-04-29 10:14:50 CEST
</div>
</div>
</body>
</html>