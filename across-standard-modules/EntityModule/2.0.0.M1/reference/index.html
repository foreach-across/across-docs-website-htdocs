<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.0">
<meta name="author" content="Arne Vandamme">
<title>EntityModule</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic|Noto+Serif:400,400italic,700,700italic|Droid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic|Noto+Serif:400,400italic,700,700italic|Droid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-check-square-o:first-child,ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after,a[href^="mailto:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>EntityModule</h1>
<div class="details">
<span id="author" class="author">Arne Vandamme</span><br>
<span id="revdate">2.0.0.M1</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_about">About</a></li>
<li><a href="#_general_information">1. General information</a>
<ul class="sectlevel2">
<li><a href="#_artifact">1.1. Artifact</a></li>
<li><a href="#_module_dependencies">1.2. Module dependencies</a></li>
<li><a href="#_module_settings">1.3. Module settings</a></li>
</ul>
</li>
<li><a href="#_what_s_new_in_this_version">2. What&#8217;s new in this version?</a>
<ul class="sectlevel2">
<li><a href="#_2_0_0_m1">2.0.0.M1</a></li>
</ul>
</li>
<li><a href="#_about_the_entitymodule">3. About the EntityModule</a>
<ul class="sectlevel2">
<li><a href="#_entityconfiguration_and_entityassociation">3.1. EntityConfiguration and EntityAssociation</a></li>
<li><a href="#_integration_with_spring_data_repositories">3.2. Integration with Spring Data repositories</a></li>
</ul>
</li>
<li><a href="#_configuring_entity_types">4. Configuring entity types</a>
<ul class="sectlevel2">
<li><a href="#builders">4.1. Using builders</a></li>
<li><a href="#_configuring_properties">4.2. Configuring properties</a></li>
<li><a href="#_creating_an_entityconfiguration_manually">4.3. Creating an EntityConfiguration manually</a></li>
<li><a href="#_automatic_registration_of_entity_types">4.4. Automatic registration of entity types</a></li>
</ul>
</li>
<li><a href="#_integration_with_other_modules">5. Integration with other modules</a>
<ul class="sectlevel3">
<li><a href="#integration:adminwebmodule">5.1. AdminWebModule</a></li>
</ul>
</li>
<li><a href="#_entity_associations">6. Entity associations</a>
<ul class="sectlevel2">
<li><a href="#_parentdeletemode">6.1. ParentDeleteMode</a></li>
<li><a href="#_association_naming_and_location">6.2. Association naming and location</a></li>
</ul>
</li>
<li><a href="#_entity_views">7. Entity views</a>
<ul class="sectlevel2">
<li><a href="#_list_view">7.1. List view</a></li>
<li><a href="#delete-view">7.2. Delete view</a></li>
<li><a href="#_custom_views">7.3. Custom views</a></li>
<li><a href="#_entitylinkbuilder">7.4. EntityLinkBuilder</a></li>
</ul>
</li>
<li><a href="#_customizing_generated_entity_views">8. Customizing generated Entity views</a>
<ul class="sectlevel2">
<li><a href="#_changing_entity_names_property_names_or_other_labels">8.1. Changing entity names, property names or other labels</a></li>
<li><a href="#_specifying_a_custom_template">8.2. Specifying a custom template</a></li>
<li><a href="#_entityviewprocessor">8.3. EntityViewProcessor</a></li>
<li><a href="#_using_a_custom_entityviewfactory">8.4. Using a custom EntityViewFactory</a></li>
<li><a href="#entity-list-view-custom-filter">8.5. Adding a custom filter to a list view</a></li>
<li><a href="#_selecting_properties">8.6. Selecting properties</a></li>
<li><a href="#_customizing_fieldsets">8.7. Customizing fieldsets</a></li>
<li><a href="#_customizing_entity_validation">8.8. Customizing entity validation</a></li>
<li><a href="#_customizing_strong_value_strong_mode_elements">8.9. Customizing <strong>VALUE</strong> mode elements</a></li>
<li><a href="#_customizing_textbox_elements">8.10. Customizing textbox elements</a></li>
<li><a href="#_customizing_numeric_elements">8.11. Customizing numeric elements</a></li>
<li><a href="#_customizing_datetime_picker_elements">8.12. Customizing datetime picker elements</a></li>
</ul>
</li>
<li><a href="#_default_entity_configuration">9. Default entity configuration</a>
<ul class="sectlevel2">
<li><a href="#_auditable">9.1. Auditable</a></li>
</ul>
</li>
<li><a href="#entity-query">10. EntityQuery infrastructure</a>
<ul class="sectlevel2">
<li><a href="#entity-query-executor">10.1. EntityQueryExecutor</a></li>
<li><a href="#entity-query-language">10.2. EntityQuery Language (EQL)</a></li>
<li><a href="#_eql_filtering_on_list_view">10.3. EQL filtering on list view</a></li>
<li><a href="#_extending_eql">10.4. Extending EQL</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="openblock copyright">
<div class="content">
<div class="paragraph">
<p>Copyright &#169; 2014-2015<br>
<span class="small">Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically.</span></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_about"><a class="anchor" href="#_about"></a>About</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Module website: <a href="https://foreach.atlassian.net/wiki/display/AX/EntityModule" class="bare">https://foreach.atlassian.net/wiki/display/AX/EntityModule</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_general_information"><a class="anchor" href="#_general_information"></a>1. General information</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_artifact"><a class="anchor" href="#_artifact"></a>1.1. Artifact</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.foreach.across.modules&lt;/groupId&gt;
        &lt;artifactId&gt;entity-module&lt;/artifactId&gt;
        &lt;version&gt;2.0.0.M1&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_module_dependencies"><a class="anchor" href="#_module_dependencies"></a>1.2. Module dependencies</h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Module dependencies</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Module</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#integration:adminwebmodule">AdminWebModule</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables auto generated forms for managing the registered entities.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_module_settings"><a class="anchor" href="#_module_settings"></a>1.3. Module settings</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entityModule.entityValidator.registerForMvc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Should the entity Validator instance be registered as the default validator for MVC databinding.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_s_new_in_this_version"><a class="anchor" href="#_what_s_new_in_this_version"></a>2. What&#8217;s new in this version?</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_2_0_0_m1"><a class="anchor" href="#_2_0_0_m1"></a>2.0.0.M1</h3>
<div class="paragraph">
<p>This release has a lot of breaking changes compared with the previous release.
The code has been heavily rewritten and optimized.
The public API modified accordingly with a focus on simplification and future extensibility.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>requires Across 2.0.0+</p>
</li>
<li>
<p>massive overhaul of the <code>EntitiesConfigurationBuilder</code> system - removed the <code>and()</code> concatenating of builder calls</p>
<div class="ulist">
<ul>
<li>
<p>nested builder consumers are used instead - this greatly simplified the class hierarchy involved</p>
</li>
</ul>
</div>
</li>
<li>
<p>externalized the entire <code>ViewElement</code> infrastructure to <a href="https://foreach.atlassian.net/wiki/display/AX/BootstrapUiModule">BootstrapUiModule</a></p>
<div class="ulist">
<ul>
<li>
<p>if <a href="https://foreach.atlassian.net/wiki/display/AX/BootstrapUiModule">BootstrapUiModule</a> is not present, default views will not be created</p>
</li>
</ul>
</div>
</li>
<li>
<p>compatibility update with Spring 4.2 which replaces <code>CrudInvoker</code> with <code>RepositoryInvoker</code> from spring-data-commons.</p>
</li>
<li>
<p>principal names on <code>Auditable</code> entities are now pretty printed using the <code>SecurityPrincipalLabelResolverStrategy</code> from the <em>SpringSecurityModule</em></p>
</li>
<li>
<p>EntityModule now supports <a href="#delete-view">deleting of entities</a></p>
</li>
<li>
<p>the <code>EntityModel</code> of an <code>EntityConfiguration</code> can now be customized using the <a href="#builders"><code>EntityConfigurer</code> builders</a></p>
</li>
<li>
<p>extension of the <a href="#entity-query">EntityQuery infrastructure</a></p>
<div class="ulist">
<ul>
<li>
<p>addition of the <a href="#entity-query-language">EntityQuery Language (EQL)</a> providing SQL-like syntax for building an <code>EntityQuery</code></p>
</li>
<li>
<p>provide a default <a href="#list-view-filter">EQL-based filter for list views</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_about_the_entitymodule"><a class="anchor" href="#_about_the_entitymodule"></a>3. About the EntityModule</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_entityconfiguration_and_entityassociation"><a class="anchor" href="#_entityconfiguration_and_entityassociation"></a>3.1. EntityConfiguration and EntityAssociation</h3>

</div>
<div class="sect2">
<h3 id="_integration_with_spring_data_repositories"><a class="anchor" href="#_integration_with_spring_data_repositories"></a>3.2. Integration with Spring Data repositories</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_entity_types"><a class="anchor" href="#_configuring_entity_types"></a>4. Configuring entity types</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="builders"><a class="anchor" href="#builders"></a>4.1. Using builders</h3>
<div class="paragraph">
<p>Entities are usually automatically added to the <code>EntityRegistry</code> through the use of one or more <code>EntityRegistrar</code> beans.
The registrars will apply a default configuration, usually consisting of all properties, associations and views.</p>
</div>
<div class="paragraph">
<p>Customizing the <code>EntityRegistry</code> is done by implementing one or more <code>EntityConfigurer</code> beans in your modules.
These receive an <code>EntitiesConfigurationBuilder</code> that effectively allows you to customize all registered <code>EntityConfiguration</code> instances.
Multiple <code>EntityConfigurer</code> beans can modify the same <code>EntityConfiguration</code>, the order in which they are applied will determine the last value if they modify the same properties.</p>
</div>
<div class="paragraph">
<p>Investigate the javadoc of the <code>EntitiesConfigurationBuilder</code> and child builders to discover all possible configuration options.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@AcrossDepends(required = "EntityModule")
@Configuration
public class UserEntitiesConfiguration implements EntityConfigurer
{
	@Override
	public void configure( EntitiesConfigurationBuilder configuration ) {
		// By default permissions cannot be managed through the user interface
		configuration.withType( Permission.class ).hide();
	}
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_properties"><a class="anchor" href="#_configuring_properties"></a>4.2. Configuring properties</h3>
<div class="paragraph">
<p>Properties for an entity can be configured through the builders as well.
New properties can be added or the default properties can modified.
How properties are configured determines how they will be rendered on the generated forms.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">hidden</dt>
<dd>
<p>A hidden property will by default not be returned when requesting all properties from an <code>EntityPropertyRegistry</code>.
You can still get this property directly however, the <code>hidden</code> state means a property will not advertise itself, you must know of its existence.</p>
</dd>
<dt class="hdlist1">readable</dt>
<dd>
<p>Any readable property can be rendered in all views.
This state means that a form control can always be generated, even though it might very well be readonly if the property is not <code>writable</code>.</p>
</dd>
<dt class="hdlist1">writable</dt>
<dd>
<p>A writable property can be rendered in form views.
In case a property is writable but not readable, the property can only be included in forms but not in other views.</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The <code>hidden</code> state has no correlation with a hidden form control.
Setting a property to be rendered as a hidden form control can only be done through configuring the right <code>ViewElement</code> information for that property.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_configuring_a_label"><a class="anchor" href="#_configuring_a_label"></a>4.2.1. Configuring a label</h4>
<div class="paragraph">
<p>An entity with a corresponding <code>EntityConfiguration</code> always has a label, this is a textual representation of the entity in for example lists.
This could be the <strong>name</strong> or the * title* property for example.
By default the label corresponds to a custom generated property <strong>#label</strong> that defaults to calling <code>toString()</code> on the entity.</p>
</div>
<div class="paragraph">
<p>You can configure the label using the <code>label()</code> method on a <code>PropertyDescriptorBuilder</code>.
This is equivalent to calling <code>property("#label")</code>.
If you want to use another property as the base for label generation, you can configure this on the <code>EntityConfigurationBuilder</code> by calling <code>label("propertyName")</code>.
This will copy all settings from the source property to the <strong>#label</strong> property, but keep in mind it still is a separate property that can be customized.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Override
public void configure( EntitiesConfigurationBuilder entities ) {
    // Configure the username to be used as label for a User entity
    entities.withType( User.class ).label( "username" );

    // Configure the group name to be used as base label, but modify the value fetcher so
    // the label is prefixed with Group
    entities.withType( Group.class )
            .properties( props -&gt; props.label( "name" ).spelValueFetcher( "'Group: ' + name" ) );
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you do not wish to use the <strong>#label</strong> property at all as default entity label, you can customize the <code>Printer</code> used for label generation by modifying the <code>EntityModel</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As <strong>#label</strong> is a generated property, sorting is not enabled by default.
If you configure the label using an existing property, the sortable attribute will be copied as well and sorting on label will be possible.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_an_entityconfiguration_manually"><a class="anchor" href="#_creating_an_entityconfiguration_manually"></a>4.3. Creating an EntityConfiguration manually</h3>
<div class="sect3">
<h4 id="_attributes_to_configure"><a class="anchor" href="#_attributes_to_configure"></a>4.3.1. Attributes to configure</h4>
<div class="paragraph">
<p>Some attributes are mandatory, others are optional but will often impact how much functionality is available out of the box.
You can configure any attribute you like, see the section on <a href="#automatic-attributes">automatic registration</a> for a list of common attributes provided by other registrars.</p>
</div>
</div>
<div class="sect3">
<h4 id="_entityqueryexecutor"><a class="anchor" href="#_entityqueryexecutor"></a>4.3.2. EntityQueryExecutor</h4>
<div class="paragraph">
<p>In order for generated views to work automatically, an <code>EntityConfiguration</code> should have an <code>EntityQueryExecutor</code> attribute.
The <code>EntityQueryExecutor</code> is a generic interface that supports the simple <code>EntityQuery</code> abstraction for fetching entities from the backing repository.
Default implementations exist for <code>JpaSpecificationExecutor</code> and <code>QueryDslPredicateExecutor</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_automatic_registration_of_entity_types"><a class="anchor" href="#_automatic_registration_of_entity_types"></a>4.4. Automatic registration of entity types</h3>
<div class="sect3">
<h4 id="automatic-attributes"><a class="anchor" href="#automatic-attributes"></a>4.4.1. Registered EntityConfiguration attributes</h4>
<div class="paragraph">
<p>Some of these may or may not be available depending on how the entity was registered.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Repository.class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In case of an entity registered through a Spring data repository.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RepositoryFactoryInformation.class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In case of an entity registered through a Spring data repository.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PersistentEntity.class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In case of an entity registered through a Spring data repository that exposed <code>PersistentEntity</code> information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EntityQueryExecutor.class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Holds the <code>EntityQueryExecutor</code> that can be used for <a href="#entity-query">custom <code>EntityQuery</code> execution</a> and will be used by default for fetching entities.
Available if the <code>Repository</code> was supported by one of the <a href="#entity-query-executor">default <code>EntityQueryExecutor</code> implementations</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EntityQueryParser.class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Holds the <code>EntityQueryParser</code> that should be used for <a href="#entity-query-language">parsing EQL statements</a> into a valid <code>EntityQuery</code>.
Available if the <code>EntityQueryExecutor.class</code> attribute is present.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_registered_entitypropertydescriptor_attributes"><a class="anchor" href="#_registered_entitypropertydescriptor_attributes"></a>4.4.2. Registered EntityPropertyDescriptor attributes</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PersistentProperty.class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In case of a property of a <code>PersistentEntity</code> registered through a Spring data repository.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Sort.Order.class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains the default <code>Sort.Order</code> if sorting is enabled on this property.
By default strings have an order that ignores case.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EntityAttributes.CONTROL_NAME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional: required to be a <code>String</code> value.
When present this value will be used as the form control name instead of the descriptor name.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_integration_with_other_modules"><a class="anchor" href="#_integration_with_other_modules"></a>5. Integration with other modules</h2>
<div class="sectionbody">
<div class="sect3">
<h4 id="integration:adminwebmodule"><a class="anchor" href="#integration:adminwebmodule"></a>5.1. AdminWebModule</h4>
<div class="paragraph">
<p>If the <code>AdminWebModule</code> is present entity management controllers will be created for all registered entity configurations.
If you want to avoid the automatic registration of entity management controllers for a particular entity type, you should set the <code>EntityConfiguration</code> as <code>hidden</code>.
This will effectively disable the default entity controllers for that type, and hide the existence of the entity type from the administration interface.</p>
</div>
<div class="paragraph">
<p>You can also hide one or more associations.
By default an association will not be shown if one of the participating entities is hidden.
If you specify the <code>hidden</code> property of an <code>EntityAssociation</code> explicitly, that value will take precedence of the entity configurations.
This way it is possible to generate management pages for associated entities, but not for the main entity type.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_entity_associations"><a class="anchor" href="#_entity_associations"></a>6. Entity associations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>EntityModule</code> attempts to automatically detect related entities and creates associations mainly to facilitate UI generation.
Currently <code>@OneToMany</code>, <code>@ManyToMany</code> and <code>@ManyToOne</code> annotations from <code>javax.persistence</code> API are all scanned and used to build <code>EntityAssociation</code> entries.</p>
</div>
<div class="paragraph">
<p>In the administrative UI the management of related entities can often be done either through the property or the association.
This is especially the case for <code>@ManyToMany</code> and <code>@OneToMany</code> associations that are mapped through a property with collection type.
By default related entity management will be done through the property and the association will be generated but hidden.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you want to enable management through the association interface, you should manipulate the <code>hidden</code> property of both the association and the property using an <code>EntityConfigurer</code>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Override
public void configure( EntitiesConfigurationBuilder configuration ) {
    // Groups should be managed through the association instead of the property
    configuration.withType( MachinePrincipal.class )
                 .properties( props -&gt; props.property( "groups" ).hidden( true ) )
                 .association( ab -&gt; ab.name( "machinePrincipal.groups" ).show() );
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_parentdeletemode"><a class="anchor" href="#_parentdeletemode"></a>6.1. ParentDeleteMode</h3>
<div class="paragraph">
<p>An <code>EntityAssociation</code> has a <strong>parentDeleteMode</strong> property that determines how associated items will influence the ability to delete in the user interface.
The default value is <code>SUPPRESS</code> but can be set through the <code>EntitiesConfigurationBuilder</code>.</p>
</div>
<div class="paragraph">
<p>For more information see the <a href="#delete-view">delete view chapter</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_association_naming_and_location"><a class="anchor" href="#_association_naming_and_location"></a>6.2. Association naming and location</h3>
<div class="paragraph">
<p>Associations are added to the <code>EntityConfiguration</code> for which it makes most sense to manage them from a UI perspective.
The association naming however is done according to the entity class and property names.</p>
</div>
<div class="paragraph">
<p>Example:
* entity <code>Group</code>
* entity <code>User</code> has a one to many with <code>Group</code> on property <strong>group</strong>
* association <strong>user.group</strong> will be created on the entity configuration of <code>Group</code></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_entity_views"><a class="anchor" href="#_entity_views"></a>7. Entity views</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_list_view"><a class="anchor" href="#_list_view"></a>7.1. List view</h3>
<div class="sect3">
<h4 id="list-view-filter"><a class="anchor" href="#list-view-filter"></a>7.1.1. Filtering a list view</h4>
<div class="paragraph">
<p>By default a list view is not filtered.
If your entity has an <a href="#entity-query-executor"><code>EntityQueryExecutor</code></a> available you can easily activate a simple yet powerful <a href="#entity-query-language">EQL-based filter</a>.
Activating <code>EntityQuery</code> based filtering can be done through the builders:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// Activate the EQL-based filter on every entity that has an EntityQueryExecutor
configuration.matching( c -&gt; c.hasAttribute( EntityQueryExecutor.class ) )
             .listView( lvb -&gt; lvb.entityQueryFilter( true ) );</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#entity-list-view-custom-filter">this chapter</a> for information on how to configure a custom filter for a list view.</p>
</div>
</div>
<div class="sect3">
<h4 id="_list_summary_view"><a class="anchor" href="#_list_summary_view"></a>7.1.2. List summary view</h4>
<div class="paragraph">
<p>It is possible to activate a detail view inline in a list view.
If the <code>EntityConfiguration</code> or <code>EntityAssociation</code> has a view named <strong>listSummaryView</strong> a summary pane will automatically become available when clicking on the item row in the table.
The summary pane is called using AJAX and only the <em>content</em> fragment of the page will be rendered.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// Activate a summary view in the main user results table using a custom Thymeleaf template
configuration.withType( User.class )
             .view( EntityListView.SUMMARY_VIEW_NAME, vb -&gt; vb.template( "th/myModule/userSummary" ) );</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="delete-view"><a class="anchor" href="#delete-view"></a>7.2. Delete view</h3>
<div class="paragraph">
<p>A delete action will be available for all entities where <code>AllowableAction.DELETE</code> is present, this is the default unless more explicit permissions are configured.
A delete will always redirect to a confirmation page by default.
Because the possibility to delete an entity often depends on other factors (usually associations), the default <code>EntityDeleteViewFactory</code> publishes an event that allows customizing said confirmation page.</p>
</div>
<div class="paragraph">
<p>By catching the <code>BuildEntityDeleteViewEvent</code> your code can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>suppress the ability to delete (by hiding the delete button)</p>
</li>
<li>
<p>add associations to the form</p>
</li>
<li>
<p>add custom feedback messages to the form (and optionally remove the associations block)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This should be sufficient for most use cases without having to revert to custom <code>EntityViewProcessor</code> implementations.
Of course the latter would work as well.</p>
</div>
<div class="paragraph">
<div class="title">Entity associations</div>
<p>The initial <code>BuildEntityDeleteViewEvent</code> is configured based on the <code>EntityAssociation</code> list of the entity.
If associated items are detected, they influence the form settings depending on the <strong>parentDeleteMode</strong> property of the <code>EntityAssociation</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ParentDeleteMode.IGNORE</code>: item information is not printed nor influences the ability to delete</p>
</li>
<li>
<p><code>ParentDeleteMode.WARN</code>: item information is printed on the form but does not influence the ability to delete</p>
</li>
<li>
<p><code>ParentDeleteMode.SUPPRESS</code>: item information is printed on the form and disables the ability to delete, this is the default setting</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The event is published after the initial association information has been set.</p>
</div>
<div class="paragraph">
<div class="title">Performing the delete</div>
<p>The EntityModule simply calls the delete method of the <code>EntityModel</code>, usually a direct call to a repository <code>delete()</code>.
You will have to take care yourself of complex delete scenarios - like deleting the associations - by either modifying the <code>EntityModel</code> or using another mechanism like the <code>EntityInterceptor</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_custom_views"><a class="anchor" href="#_custom_views"></a>7.3. Custom views</h3>

</div>
<div class="sect2">
<h3 id="_entitylinkbuilder"><a class="anchor" href="#_entitylinkbuilder"></a>7.4. EntityLinkBuilder</h3>
<div class="paragraph">
<p>An <code>EntityConfiguration</code> or <code>EntityAssociation</code> can have one or more <code>EntityLinkBuilder</code> instances registered in its attributes.
An <code>EntityLinkBuilder</code> is used to create application links to management controllers for the entity.
By default the <code>EntityModule</code> will create an <code>EntityLinkBuilder</code> for the management pages in admin web if <code>AdminWebModule</code> is present, and this link builder will be registered as the attribute with <code>EntityLinkBuilder</code> class as key.</p>
</div>
<div class="paragraph">
<p>You can use the <code>EntityLinkBuilder</code> directly for example in redirects, often the specific <code>EntityLinkBuilder</code> is overridable per view.
All links the <code>EntityLinkBuilder</code> generates are entirely configurable, please refer to the javadoc for all possible settings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">EntityLinkBuilder linkBuilder = entityConfiguration.getAttribute( EntityLinkBuilder.class );

// Will create a link of the form "/entities/{parent}/{parentId}/update"
String path = linkBuilder.update( parent );</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_entitylinkbuilder_for_associations"><a class="anchor" href="#_entitylinkbuilder_for_associations"></a>7.4.1. EntityLinkBuilder for associations</h4>
<div class="paragraph">
<p>Associations usually also have an <code>EntityLinkBuilder</code> registered, it is possible to create links to items that are an association from a parent entity.
To achieve this you must <em>scope</em> the <code>EntityLinkBuilder</code> to the parent entity it belongs to.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">EntityLinkBuilder linkBuilder = entityConfiguration.getAttribute( EntityLinkBuilder.class );

EntityConfiguration associated = association.getTargetEntityConfiguration();
EntityLinkBuilder associatedLinkBuilder = association.getAttribute( EntityLinkBuilder.class )
                                                     .asAssociationFor( linkBuilder, parent );

// Will create a link of the form "/entities/{parent}/{parentId}/associations/{associationName}/{childId}/update"
String path = associatedLinkBuilder.update( child );</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_customizing_generated_entity_views"><a class="anchor" href="#_customizing_generated_entity_views"></a>8. Customizing generated Entity views</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following section gives an overview of common custimizations for generated entity views.</p>
</div>
<div class="sect2">
<h3 id="_changing_entity_names_property_names_or_other_labels"><a class="anchor" href="#_changing_entity_names_property_names_or_other_labels"></a>8.1. Changing entity names, property names or other labels</h3>
<div class="paragraph">
<p>Labels are resolved using a message code hierarchy.
Simply define one or more message sources specifying the properties you want.
Unless custom <code>EntityMessageCodeResolver</code> instances are being used, message codes are generated as follows:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Message code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">enums.<strong>EnumName</strong>.<strong>EnumValue</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message code for a single enum value label.<br>
Example: <em>enums.Numbers.ONE</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>EntityPrefix</strong>.name.singular</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Label for an entity in singular form, for use outside or at the beginning of a sentence.<br>
Example: <em>UserModule.entities.user.name.singular</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>EntityPrefix</strong>.name.plural</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Label for an entity in plural form, for use outside or at the beginning of a sentence.<br>
Example: <em>UserModule.entities.user.name.plural</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>EntityPrefix</strong>.name.singular.inline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Label for an entity in singular form, for use within a sentence. If not explicitly specified, the label is
generated based by lower-casing the non-inline version.<br>
Example: <em>UserModule.entities.user.name.singular.inline</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>EntityPrefix</strong>.name.plural.inline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Label for an entity in plural form, for use within a sentence.  If not explicitly specified, the label is
 generated based by lower-casing the non-inline version.<br>
Example: <em>UserModule.entities.user.name.plural.inline</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>EntityPrefix</strong>.properties.<strong>propertyName</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Label for a single entity property.<br>
Example: <em>UserModule.entities.user.properties.username</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>EntityPrefix</strong>.properties.<strong>propertyName</strong>[description]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description text for a property.  If not empty this will be rendered in a help block on forms.<br>
Example: <em>UserModule.entities.user.properties.username[description]</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>EntityPrefix</strong>.properties.<strong>propertyName</strong>[placeholder]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Placeholder text for a property.  Will be used for certain controle like textbox.<br>
Example: <em>UserModule.entities.user.properties.username[placeholder]</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>EntityPrefix</strong>.validation.<strong>validatorKey</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description text for a validation error message.  Optionally can be suffixed with the specific property name.<br>
Example: <em>UserModule.entities.user.validation.NotBlank</em>,  <em>UserModule.entities.user.validation.alreadyExists.username</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">actions.*</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p><em>Entity</em> codes are camel cased</p>
</li>
<li>
<p>EntityPrefix: ModuleName.entities.entityName, or EntityModule.entities.entityName or simply entityName</p>
</li>
<li>
<p>Hierarchical lookups: entity can be removed, module can be replaced by EntityModule</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_specifying_a_custom_template"><a class="anchor" href="#_specifying_a_custom_template"></a>8.2. Specifying a custom template</h3>
<div class="paragraph">
<p>Every default view uses a specific (Thymeleaf) template that renders the <code>ViewElement`s created by the view.
If you want control over the rendering through a separate template you can specify a different template using `template()</code> method on the <code>EntityViewFactoryBuilder</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_entityviewprocessor"><a class="anchor" href="#_entityviewprocessor"></a>8.3. EntityViewProcessor</h3>
<div class="paragraph">
<p>Modifying a default view can be done by registerin an <code>EntityViewProcessor</code> for that view.
This API allows you to modify the <code>ViewElement</code> collection that should be generated.
This is a useful hook to add for example custom form elements that you wish to add and process.
If can also be used to reorganize the layout of the form from backend code using the <code>ContainerViewElementUtils</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_a_custom_entityviewfactory"><a class="anchor" href="#_using_a_custom_entityviewfactory"></a>8.4. Using a custom EntityViewFactory</h3>
<div class="paragraph">
<p>Full control can be done by registering a custom <code>EntityViewFactory</code> implementation.</p>
</div>
</div>
<div class="sect2">
<h3 id="entity-list-view-custom-filter"><a class="anchor" href="#entity-list-view-custom-filter"></a>8.5. Adding a custom filter to a list view</h3>
<div class="paragraph">
<p>A filter on a list view usually consists of 2 parts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an <code>EntityViewProcessor</code> that provides the filtering options on the list view</p>
</li>
<li>
<p>a custom <code>EntityListViewPageFetcher</code> that supports the filtering options when fetching the entities</p>
<div class="ulist">
<ul>
<li>
<p>a custom form is usually added to the <code>EntityViewCommand.setExtensions()</code> for both postback and optional validation</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>EntityListViewFactoryBuilder</code> provides a <code>filter()</code> method that will register both parts if you component implements both interfaces.</p>
</div>
<div class="paragraph">
<p><strong>Custom filter example</strong></p>
</div>
<div class="paragraph">
<p>The following code illustrates adding a simple filter to a view.
The filter uses a separate repository method to lookup entities by name.
The filter options are added as a form on top of the list view, the form in this case rendered via a custom Thymeleaf template.</p>
</div>
<div class="listingblock">
<div class="title">Implementation of a single class that holds all filter logic</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">private static class GroupFilteringProcessor extends WebViewProcessorAdapter&lt;EntityListView&gt; implements EntityListViewPageFetcher&lt;WebViewCreationContext&gt;
{
	@Autowired
	private GroupRepository groupRepository;

	@Override
	protected void registerCommandExtensions( EntityViewCommand command ) {
		command.addExtensions( "filter", "" );
	}

	@Override
	protected void modifyViewElements( ContainerViewElement elements ) {
		// move the original actions
		Optional&lt;ContainerViewElement&gt; header = find( elements, "entityForm-header",
		                                              ContainerViewElement.class );
		header.ifPresent(
				h -&gt; {
					Optional&lt;NodeViewElement&gt; actions
							= find( h, "entityForm-header-actions", NodeViewElement.class );
					actions.ifPresent( a -&gt; a.addCssClass( "pull-right" ) );

					h.addChild( new TemplateViewElement( "th/entityModuleTest/group :: filterForm" ) );
				}
		);
	}

	@Override
	public Page fetchPage( WebViewCreationContext viewCreationContext, Pageable pageable, EntityView model ) {
		EntityViewRequest request = model.getAttribute( "viewRequest" );

		String filter = (String) request.getExtensions().get( "filter" );
		if ( !StringUtils.isBlank( filter ) ) {
			return groupRepository.findByNameContaining( filter, pageable );
		}

		return groupRepository.findAll( pageable );
	}
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Custom Thymeleaf template that builds the form</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;fragments xmlns:th="http://www.w3.org/1999/xhtml"&gt;
    &lt;div class="list-header form form-inline" th:fragment="filterForm"&gt;
        &lt;div class="form-group"&gt;
            &lt;label for="group-name-filter"&gt;Filter by name:&lt;/label&gt;
            &lt;input id="group-name-filter" name="extensions[filter]" th:value="${viewRequest.extensions['filter']}" type="text" class="form-control" /&gt;
        &lt;/div&gt;
        &lt;input type="submit" class="btn btn-default" value="Apply filter" /&gt;
    &lt;/div&gt;
&lt;/fragments&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Registration of the custom filter on the list view</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">entities.withType( Group.class )
        .listView( lvb -&gt; lvb
            .entityQueryFilter( false )           // optional - disable the previously activated entity query filter
            .filter( groupFilteringProcessor() )  // register the custom filter
		);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_selecting_properties"><a class="anchor" href="#_selecting_properties"></a>8.6. Selecting properties</h3>
<div class="paragraph">
<p><code>EntityPropertySelector</code>, incremental builders, keep current, select all, select all without default filter, exclude</p>
</div>
</div>
<div class="sect2">
<h3 id="_customizing_fieldsets"><a class="anchor" href="#_customizing_fieldsets"></a>8.7. Customizing fieldsets</h3>

</div>
<div class="sect2">
<h3 id="_customizing_entity_validation"><a class="anchor" href="#_customizing_entity_validation"></a>8.8. Customizing entity validation</h3>
<div class="paragraph">
<p>By default annotation validation is performed on all entities.
Customizing validation can be done by simply specifying a <code>Validator</code> bean that supports the specific entity type.
You can use the <code>EntityValidatorSupport</code> as a base class to extend the default annotation based entity validation.</p>
</div>
<div class="paragraph">
<p>If more than one <code>Validator</code> could be applied, you will manually have to set the <code>Validator.class</code> attribute on the <code>EntityConfiguration</code> to the correct one.</p>
</div>
</div>
<div class="sect2">
<h3 id="_customizing_strong_value_strong_mode_elements"><a class="anchor" href="#_customizing_strong_value_strong_mode_elements"></a>8.9. Customizing <strong>VALUE</strong> mode elements</h3>
<div class="paragraph">
<p>The <code>ViewElementMode.VALUE</code> and <code>ViewElementMode.LIST_VALUE</code> are the defaults to provide the output of a property for readonly views.
Unless a specific <code>ViewElement</code> is configured, this will always be a <code>String</code> output of the property.
By default the <strong>mvcConversionService</strong> will be used to convert the property value if no type specific builder is provided.</p>
</div>
<div class="paragraph">
<p>Apart from providing a custom <code>ViewElement</code> you can also modify the rendered output by providing attributes on the <code>EntityPropertyDescriptor</code>.
If you provide a <code>org.springframework.format.Printer.class</code> attribute, that implementation will be used for printing the text value.
Alternatively you can provide a <code>java.text.Format.class</code> attribute to be used.
Note that most default <code>Format</code> implementations are not thread-safe, in that case you should wrap them in a <code>SynchronizedFormat</code> instance.</p>
</div>
<div class="paragraph">
<p>All standard view elements will use the <code>Printer</code> or <code>Format</code> attribute if one of them is present, instead of the default.
A <code>Printer</code> attribute takes precedence over a <code>Format</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_customizing_textbox_elements"><a class="anchor" href="#_customizing_textbox_elements"></a>8.10. Customizing textbox elements</h3>
<div class="paragraph">
<p><code>TextboxFormElement.Type</code> can be set as an attribute on the <code>EntityPropertyDescriptor</code>.
If set and the property is generated as a <code>TextboxFormElement</code>, that type will be used.</p>
</div>
<div class="paragraph">
<p>You can add default post processors to the <code>TextboxFormElementBuilderFactory</code> to customize the autodetection.</p>
</div>
</div>
<div class="sect2">
<h3 id="_customizing_numeric_elements"><a class="anchor" href="#_customizing_numeric_elements"></a>8.11. Customizing numeric elements</h3>
<div class="paragraph">
<p>By default all <code>Number</code> type properties will result in a <code>NumericFormElement</code> being used which is rendered as a textbox.
The behavior can be customized by providing a <code>NumericFormElementConfiguration</code>.
A default configuration will only be created for properties annotated with a Spring <code>@NumberFormat</code> for type <code>CURRENCY</code> or <code>PERCENT</code>, if no <code>NumericFormElementConfiguration.class</code> or <code>NumericFormElementConfiguration.Format.class</code> attribute is present.</p>
</div>
<div class="paragraph">
<p>If a <code>NumericFormElementConfiguration</code> is present a more advanced javascript control will be used in the front-end for value input.
The same configuration will also be used for rendering the <strong>VALUE</strong> mode elements, formatting the output according to the properties configured.</p>
</div>
<div class="paragraph">
<div class="title">Manually configuring percent</div>
<p>Put a format attribute with value <code>PERCENT</code> on the <code>EntityPropertyDescriptor</code>.
This will create a locale specific percentage format with 2 decimals (unless the property type is integer).
Alternatively use the static <code>NumericFormElementConfiguration.percent()</code> factory method to quickly create a localizable format suitable for percentages.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you use Spring number format for <code>PERCENT</code> then 1 is expected to match 100%.
If you manually create a <code>NumericFormElementConfiguration</code> it expects 100 to match with 100%.
You can modify this behavior by setting the <code>multiplier</code> property on the configuration.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Manually configuring currency</div>
<p>The easiest way to configure a currency is to set a <code>Currency.class</code> attribute for the property.
In that case a locale specific format for that currency will be created.
Alternatively the same options as for percentages can be used and there is a <code>NumericFormElementConfiguration.currency()</code> factory method available.</p>
</div>
</div>
<div class="sect2">
<h3 id="_customizing_datetime_picker_elements"><a class="anchor" href="#_customizing_datetime_picker_elements"></a>8.12. Customizing datetime picker elements</h3>
<div class="paragraph">
<p>By default all <code>Date</code> properties will result in a <code>DateTimeFormElement</code> which is rendered as a date time picker.
The form element can be customized through the <code>DateTimeFormElementConfiguration</code> class.
The default configuration is determined based on the presence of <code>@Temporal</code> annotations on the property.
The date picker supports 3 major modes: <strong>date</strong>, <strong>time</strong> and <strong>timestamp</strong> (date + time) with minutes being the maximum resolution.
The presence of <code>@Past</code> and <code>@Future</code> validation annotations will additionally restrict the dates that are selectable.</p>
</div>
<div class="paragraph">
<p>A specific date picker format can easily be specified by putting a <code>DateTimeFormElementConfiguration.Format</code> attribute.
Advanced customization can be done by setting a complete <code>DateTimeFormElementConfiguration</code> as attribute.
Dynamic configuration (for example setting the first selectable date relative to the current date) can only be done by specifying a <code>DateTimeFormElementBuilder</code> manually and adding a custom post processor that modifies the <code>DateTimeFormElementConfiguration</code>.
A <code>DateTimeFormElementConfiguration</code> is always duplicated when creating an element so it is safe for post processors to modify the instance.</p>
</div>
<div class="paragraph">
<div class="title">Using dates with <code>TemporalType.TIME</code> and JPA</div>
<p>A property of type <code>java.util.Date</code> but annotated with <code>@Temporal(TemporalType.TIME)</code> will result in only time selection being available (hours and minutes).
However the <code>@Temporal</code> annotation also influences how JPA will persist the data type.
If your type was created as a timestamp in the database schema, this might result in conversion errors.
With Hibernate you can resolve this by additionally specifying a <code>@Type</code> annotation forcing the type to be persisted as timestamp.</p>
</div>
<div class="listingblock">
<div class="title">Example of a required time property that is written as a date relative to start of epoch time in the database</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@NotNull
@Column(name = "arrival_time")
@Temporal(TemporalType.TIME)
@Type( type = "timestamp")
private Date arrivalTime;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_default_entity_configuration"><a class="anchor" href="#_default_entity_configuration"></a>9. Default entity configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_auditable"><a class="anchor" href="#_auditable"></a>9.1. Auditable</h3>
<div class="paragraph">
<p>If <em>SpringSecurityModule</em> is present, EntityModule adapts the default views for <code>Auditable</code> entities.
The <strong>createdBy</strong> and <strong>lastModifiedBy</strong> properties are rendered using an <code>AuditablePrincipalPropertyViewElementBuilder</code> which uses the <code>SecurityPrincipalLabelResolverStrategy</code> to generate a pretty label for a principal (eg. full name instead of username).
The default properties are removed from default views, but an aggregated property <strong>created</strong> and <strong>lastModified</strong> is added.
The aggregated properties combine both the timestamp and the principal in a single property using the <code>AuditablePropertyViewElementBuilder</code>.</p>
</div>
<div class="paragraph">
<p>See the <code>AuditableEntityUiConfiguration</code> for full customization.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="entity-query"><a class="anchor" href="#entity-query"></a>10. EntityQuery infrastructure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>EntityModule provides an abstraction layer for querying entities.
This abstraction is built around the concept of an <code>EntityQuery</code>.</p>
</div>
<div class="paragraph">
<p>This chapter gives some insight in the setup and how to customize if so wanted.</p>
</div>
<div class="sect2">
<h3 id="entity-query-executor"><a class="anchor" href="#entity-query-executor"></a>10.1. EntityQueryExecutor</h3>
<div class="paragraph">
<p>The <code>EntityQueryExecutor</code> is responsible for executing an <code>EntityQuery</code> and returning the entities requested.
An <code>EntityConfiguration</code> can have a single <code>EntityQueryExecutor.class</code> attribute holding the executor instance.</p>
</div>
<div class="paragraph">
<p>Default implementations exist for <code>JpaSpecificationExecutor</code> and <code>QueryDslPredicateExecutor</code>.
This means that any entity configurations having a repository of this type will get an <code>EntityQueryExecutor</code> created automatically.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Since the <code>EntityQueryExecutor</code> is backed by a specific repository implementation, supported functionality also depends on the actual backing repository.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="entity-query-language"><a class="anchor" href="#entity-query-language"></a>10.2. EntityQuery Language (EQL)</h3>
<div class="paragraph">
<p>Apart from building an <code>EntityQuery</code> programmatically, one can be specified using the EntityQuery Language (EQL).
EQL provides an SQL-like syntax for building queries.  Some examples could be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name = 'john'</code></p>
</li>
<li>
<p><code>name = 'john' and birthday &gt;= '1980-01-01'</code></p>
</li>
<li>
<p><code>(name in ('john', 'jane') and birthday = today()) or birthday is EMPTY</code></p>
</li>
<li>
<p><code>children contains 'john' or children is EMPTY</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A single clause of a query consists of a <em>field</em>, followed by an <em>operator</em>, followed by one or more <em>values</em> or <em>functions</em>.
Multiple <em>values</em> for one field are grouped together inside parentheses.
Clauses can be combined using either <em>and</em> or <em>or</em>.
Operator precedence can be enforced by using parentheses around a clause.</p>
</div>
<div class="paragraph">
<p>A <em>field</em> of a query clause usually corresponds with a single property you want to query.</p>
</div>
<div class="sect3">
<h4 id="_supported_operators"><a class="anchor" href="#_supported_operators"></a>10.2.1. Supported operators</h4>
<div class="sect4">
<h5 id="_equality_operators"><a class="anchor" href="#_equality_operators"></a>Equality operators</h5>
<div class="paragraph">
<p>Usable on most property types.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>=</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">equals<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>!=</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not equals<br></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_in_not_in"><a class="anchor" href="#_in_not_in"></a>IN/NOT IN</h5>
<div class="paragraph">
<p>Usable on most property types.
These are the only operators that take a group of values as argument.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>IN</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">equal to any of the argument values<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>NOT IN</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not equal to any of the argument values<br></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_comparing_operators"><a class="anchor" href="#_comparing_operators"></a>Comparing operators</h5>
<div class="paragraph">
<p>Usable on numeric and date property types.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&gt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">greater than<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&gt;=</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">greater than or equal to<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&lt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">less than<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&#8656;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">less than or equal to<br></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_like_operators"><a class="anchor" href="#_like_operators"></a>LIKE operators</h5>
<div class="paragraph">
<p>Usable on string property types.
The argument specifies the pattern that property value should match.
The pattern can contain simple wildcard specified using <strong>%</strong>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>LIKE</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">should match the pattern specified as argument<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>NOT LIKE</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">should not match the pattern specified as argument<br></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_contains_not_contains"><a class="anchor" href="#_contains_not_contains"></a>CONTAINS/NOT CONTAINS</h5>
<div class="paragraph">
<p>Usable on collection property types.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CONTAINS</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">argument should be present in the collection<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>NOT CONTAINS</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">argument should not be present in the collection<br></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_is_empty_is_not_empty"><a class="anchor" href="#_is_empty_is_not_empty"></a>IS EMPTY/IS NOT EMPTY</h5>
<div class="paragraph">
<p>Usable on most property types, although the behaviour is slightly different for collection types.
These operators to not take any additional arguments.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>IS EMPTY</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property should be unset (null) or have no members (in case of collection) <br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>IS NOT EMPTY</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property should be set (not null) or have at least one member (in case of collection)<br></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_default_eql_functions"><a class="anchor" href="#_default_eql_functions"></a>10.2.2. Default EQL functions</h4>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Security related functions</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>currentUser()</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns the name of the current authenticated principal</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. Date and time functions</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>now()</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns current timestamp<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>today()</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns date of today<br></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_entityqueryparser"><a class="anchor" href="#_entityqueryparser"></a>10.2.3. EntityQueryParser</h4>
<div class="paragraph">
<p>The <code>EntityQueryParser</code> is responsible for converting an EQL statement into a valid <code>EntityQuery</code>.
Any entity configuration with an <code>EntityQueryExecutor</code> registered will have an <code>EntityQueryParser</code> created automatically.</p>
</div>
<div class="paragraph">
<p>The parser will validate the EQL statement and convert it to a strongly typed <code>EntityQuery</code>.
The default <code>EntityQueryParser</code> uses the entity related <code>EntityPropertyRegistry</code> to validate the query clauses.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_eql_filtering_on_list_view"><a class="anchor" href="#_eql_filtering_on_list_view"></a>10.3. EQL filtering on list view</h3>
<div class="paragraph">
<p>Any entity configuration having an <code>EntityQueryParser</code> and <code>EntityQueryExecutor</code> can enable an EQL based filter on its list views.
This can be done through the <code>entityQueryFilter()</code> method on the `EntityListViewFactoryBuilder.</p>
</div>
<div class="paragraph">
<p>The EQL filter will add a simple textbox that allows you to enter the EQL statement you want to use as filter for the list view.
Extend the <code>EntityQueryFilterProcessor</code> if you want to customize the default implementation.</p>
</div>
<div class="listingblock">
<div class="title">Enabling the default EQL filter</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">entities.withType( Group.class )
        .listView( lvb -&gt; lvb.entityQueryFilter( true )	);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_extending_eql"><a class="anchor" href="#_extending_eql"></a>10.4. Extending EQL</h3>
<div class="paragraph">
<p>The <code>EntityQuery</code> infrastructure provides some hooks you can use to extend the EQL support with application specific methods.</p>
</div>
<div class="sect3">
<h4 id="_custom_value_conversion"><a class="anchor" href="#_custom_value_conversion"></a>10.4.1. Custom value conversion</h4>
<div class="paragraph">
<p>When converting an EQL query all value arguments are first converted to an <code>EQType</code> representation before being converted into their respective Java type.
Actual type conversion is then done via the Spring <code>ConversionService</code>.
To create a custom conversion you can simply register a <code>Converter</code> that converts from the relevant <code>EQType</code> to the property type.</p>
</div>
<div class="paragraph">
<p>The following table shows how EQL arguments will be converted to their respective <code>EQType</code>:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Argument value</th>
<th class="tableblock halign-left valign-top">EQType</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EQValue</code>: name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'name'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EQString</code>: name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(name, 'name')</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EQGroup</code><br>
 - <code>EQValue</code>: name<br>
 - <code>EQString</code>: name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">users(name, 'name')</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EQFunction</code>: users<br>
   [arguments]<br>
   - <code>EQValue</code>: name<br>
   - <code>EQString</code>: name</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>By default EntityModule registers id-based lookups for all its registered entities.
So supposing you have an entity <code>User</code> with id 1 and you want to query on a property <strong>creator</strong> of type <code>User</code>, the following query would work: <code>creator = 1</code>.</p>
</div>
<div class="paragraph">
<p>When building the <code>EntityQuery</code> the value 1 would be used as the id to find the <code>User</code> instance, and the latter would be used as the argument for the final query.
If we want to replace the custom behavior and allow the user to be specified by username instead, we could easily register a custom converter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class EQValueToUserConverter implements Converter&lt;EQValue, User&gt;
{
    ...

    @Override
    public User convert( EQValue source ) {
        return userRepository.findByUsername( source.getValue() );
    }
}

...

converterRegistry.addConverter( new EQValueToUserConverter(...) );</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would allow us to execute the queries like <code>creator = john</code> or  <code>creator in (john, jane)</code>.
Any type-specific converter will take precedence over the defaults.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The example above would only work if the username can never contain any whitespace.
If it can, then we would have to specify it as a String instead and write a converter for <code>EQString</code> instead of <code>EQValue</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_adding_custom_functions"><a class="anchor" href="#_adding_custom_functions"></a>10.4.2. Adding custom functions</h4>
<div class="paragraph">
<p>An EQL function is represented by a unique name and can optionally take a number of arguments for its execution.
Adding custom functions is as easy as simply defining a <code>@Component</code> that implements the <code>EntityQueryFunctionHandler</code> interface.
All components of this type will be detected and checked when executing an EQL query.</p>
</div>
<div class="paragraph">
<p>The handler will be called with the required contextual data for the return type requested.
If you want to use a function to compare a property that has a <code>Date</code> type, your function should return a <code>Date</code> instance as well.</p>
</div>
<div class="paragraph">
<p>A single handler can support multiple functions and requested return types.</p>
</div>
<div class="listingblock">
<div class="title">Simple EntityQuery function that always returns the String hello</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">/**
 * Simple EntityQuery function that always returns the String 'hello'.
 * Example eql: name = hello() or name in (hello(), 'goodbye')
 */
@Component
public class HelloFunction implements EntityQueryFunctionHandler
{
	@Override
	public boolean accepts( String functionName, TypeDescriptor desiredType ) {
		return "hello".equals( functionName );
	}

	@Override
	public Object apply( String functionName,
	                     EQType[] arguments,
	                     TypeDescriptor desiredType,
	                     EQTypeConverter argumentConverter ) {
		return "hello";
	}
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2016-12-05 12:46:47 CET
</div>
</div>
</body>
</html>